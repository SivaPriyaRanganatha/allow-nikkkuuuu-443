<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Yuki.co ‚Ä¢ Incident Console</title>
  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#0a1a2a;
      --glass: rgba(255,255,255,.10);
      --glass2: rgba(255,255,255,.14);
      --stroke: rgba(255,255,255,.16);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --green:#00ff9d;
      --yellow:#ffd86b;
      --red:#ff5c7a;
      --blue:#7dd3fc;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      overflow:hidden;
      background:
        radial-gradient(1200px 700px at 70% 10%, rgba(125,211,252,.22), transparent 60%),
        radial-gradient(1100px 700px at 20% 20%, rgba(0,255,157,.18), transparent 60%),
        radial-gradient(900px 600px at 50% 90%, rgba(255,92,122,.12), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
    }

    /* Win11 desktop */
    .desktop{
      position:relative;
      height:100%;
      padding:18px;
    }
    .brand{
      position:absolute; left:18px; top:14px;
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.08);
      border-radius:14px;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      user-select:none;
    }
    .brand .logo{
      width:34px; height:34px; border-radius:12px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(0,255,157,.95), transparent 70%),
        radial-gradient(20px 20px at 70% 70%, rgba(125,211,252,.85), transparent 70%),
        radial-gradient(18px 18px at 80% 30%, rgba(255,216,107,.75), transparent 70%),
        rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
    }
    .brand .name{
      font-weight:800;
      letter-spacing:.02em;
      line-height:1.05;
    }
    .brand .sub{
      font-size:12px; color:var(--muted);
      letter-spacing:.06em; text-transform:uppercase;
    }

    .taskbar{
      position:absolute; left:50%; bottom:14px;
      transform:translateX(-50%);
      width:min(760px, calc(100% - 28px));
      height:56px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      padding:10px 14px;
    }
    .tbIcon{
      width:36px; height:36px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.10);
      display:grid; place-items:center;
      user-select:none;
    }
    .tbIcon svg{opacity:.92}
    .tbSep{width:1px; height:28px; background: rgba(255,255,255,.14); margin:0 4px}

    /* Outlook toast */
    .toast{
      position:absolute;
      right:18px;
      bottom:86px;
      width:min(420px, calc(100% - 36px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      padding:12px 12px 12px 12px;
      display:none;
      cursor:pointer;
      transform: translateY(24px);
      opacity:0;
      animation: toastIn .55s ease forwards;
    }
    @keyframes toastIn{
      to{ transform:translateY(0); opacity:1; }
    }
    .toastRow{display:flex; gap:10px; align-items:flex-start}
    .toastIcon{
      width:38px; height:38px; border-radius:14px;
      background: rgba(125,211,252,.16);
      border:1px solid rgba(125,211,252,.25);
      display:grid; place-items:center;
      flex:0 0 auto;
    }
    .toastTitle{
      font-weight:800;
      margin:0;
      font-size:14px;
      line-height:1.2;
    }
    .toastMeta{
      margin:2px 0 0 0;
      color:var(--muted);
      font-size:12px;
      line-height:1.35;
    }
    .toastHint{
      margin:8px 0 0 0;
      color:rgba(255,255,255,.80);
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      display:inline-block;
    }

    /* Outlook mail window */
    .overlay{
      position:absolute; inset:0;
      background: rgba(0,0,0,.35);
      display:none;
      z-index:20;
    }
    .mailWin{
      position:absolute;
      left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:min(920px, calc(100% - 28px));
      height:min(560px, calc(100% - 140px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .winHead{
      height:46px;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 12px;
      border-bottom:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
    }
    .winDots{display:flex; gap:8px; align-items:center}
    .winDot{width:10px;height:10px;border-radius:50%}
    .winDot.r{background:var(--red)} .winDot.y{background:var(--yellow)} .winDot.g{background:var(--green)}
    .winTitle{
      font-weight:700;
      font-size:13px;
      color:rgba(255,255,255,.85);
      display:flex; align-items:center; gap:8px;
    }
    .winTitle .pill{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(255,216,107,.25);
      background: rgba(255,216,107,.10);
      color: rgba(255,216,107,.95);
      font-weight:800;
      letter-spacing:.05em;
      text-transform:uppercase;
    }
    .closeBtn{
      width:36px; height:30px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.85);
      cursor:pointer;
    }
    .closeBtn:hover{background: rgba(255,92,122,.18); border-color: rgba(255,92,122,.28)}
    .mailBody{
      display:grid;
      grid-template-columns: 260px 1fr;
      height: calc(100% - 46px);
    }
    @media(max-width:860px){
      .mailBody{grid-template-columns: 1fr}
      .leftPane{display:none}
    }
    .leftPane{
      border-right:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.10);
      padding:10px;
    }
    .folder{
      padding:10px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      margin-bottom:10px;
      color:rgba(255,255,255,.78);
      font-size:13px;
      display:flex; align-items:center; justify-content:space-between;
    }
    .folder b{color:rgba(255,255,255,.92)}
    .mailPane{
      padding:14px;
      overflow:auto;
    }
    .mailHdr{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      margin-bottom:10px;
    }
    .mailSubj{
      margin:0;
      font-weight:900;
      letter-spacing:.01em;
      font-size:18px;
      line-height:1.2;
    }
    .mailFrom{
      margin:6px 0 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.4;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.82);
      font-size:12px;
      white-space:nowrap;
    }
    .kv{
      margin-top:10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.16);
      padding:12px;
      font-size:13px;
      color:rgba(255,255,255,.80);
      line-height:1.55;
    }
    .kv b{color:rgba(255,255,255,.92)}
    .assignRow{
      margin-top:14px;
      display:flex; flex-wrap:wrap; gap:10px;
      align-items:center;
      position:relative;
      min-height:64px;
    }
    .btn{
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:rgba(255,255,255,.90);
      cursor:pointer;
      font-weight:900;
      letter-spacing:.01em;
    }
    .btn:hover{background: rgba(255,255,255,.12)}
    .btnYes{
      border-color: rgba(0,255,157,.30);
      background: rgba(0,255,157,.14);
      color: rgba(0,255,157,.95);
    }
    .noWrap{
      position:relative;
      width:200px;
      height:46px;
      flex:0 0 auto;
    }
    .btnNo{
      position:absolute;
      left:0; top:0;
      width:100%;
      border-color: rgba(255,92,122,.40);
      background: rgba(255,92,122,.10);
      color: rgba(255,92,122,.95);
      transition: transform .10s ease;
    }
    .attempts{
      margin-left:auto;
      color:rgba(255,255,255,.65);
      font-size:12px;
    }

    /* Terminal window (only after assignment) */
    .termWin{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      width:min(980px, calc(100% - 28px));
      height:min(640px, calc(100% - 130px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.28);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      display:none;
      z-index:15;
      overflow:hidden;
    }
    .termHead{
      height:46px;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 12px;
      border-bottom:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
    }
    .termHead .left{
      display:flex; align-items:center; gap:10px;
      color:rgba(255,255,255,.80);
      font-size:13px;
      font-weight:700;
    }
    .termHead .right{
      display:flex; align-items:center; gap:10px;
      color:rgba(255,255,255,.65);
      font-size:12px;
    }
    .hintBtn{
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(125,211,252,.28);
      background: rgba(125,211,252,.10);
      color: rgba(199,241,255,.95);
      cursor:pointer;
      font-weight:800;
      font-size:12px;
    }
    .hintBtn:hover{background: rgba(125,211,252,.14)}
    .termBody{
      display:grid;
      grid-template-columns: 1fr;
      height: calc(100% - 46px);
    }
    .screen{
      padding:14px 14px 6px;
      overflow:auto;
      height: calc(100% - 64px);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:14px;
      line-height:1.55;
      color: rgba(184,255,217,.92);
      white-space:pre-wrap;
    }
    .line{margin:0 0 6px 0}
    .tDim{color: rgba(184,255,217,.70)}
    .tOk{color: var(--green)}
    .tWarn{color: var(--yellow)}
    .tBad{color: var(--red)}
    .tInfo{color: var(--blue)}
    .tCmd{color: rgba(255,255,255,.92)}
    .inputBar{
      display:flex; gap:10px;
      align-items:center;
      padding:10px 12px;
      border-top:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      height:64px;
    }
    .cmdInput{
      flex:1;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: rgba(184,255,217,.95);
      padding:12px 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:14px;
      outline:none;
    }
    .cmdInput::placeholder{color: rgba(184,255,217,.45)}
    .runBtn{
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(0,255,157,.28);
      background: rgba(0,255,157,.12);
      color: rgba(0,255,157,.95);
      cursor:pointer;
      font-weight:900;
      letter-spacing:.01em;
    }
    .runBtn:hover{background: rgba(0,255,157,.16)}
    .hintPanel{
      position:absolute;
      right:12px;
      top:58px;
      width:min(360px, calc(100% - 24px));
      border-radius:16px;
      border:1px solid rgba(125,211,252,.26);
      background: rgba(0,0,0,.28);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      padding:12px;
      display:none;
      z-index:30;
    }
    .hintPanel h4{
      margin:0 0 6px 0;
      font-size:12px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color: rgba(199,241,255,.90);
    }
    .hintPanel p{
      margin:0;
      font-size:13px;
      color: rgba(199,241,255,.84);
      line-height:1.45;
    }

    /* Cinematic ending */
    .ending{
      position:absolute; inset:0;
      background:#000;
      display:none;
      z-index:50;
    }
    .ending .fade{
      position:absolute; inset:0;
      background:#000;
      opacity:0;
      animation: fadeIn 1.2s ease forwards;
    }
    @keyframes fadeIn{ to{opacity:1} }
    .sil{
      position:absolute;
      left:50%; top:58%;
      transform: translate(-50%,-50%);
      width:min(820px, 92vw);
      opacity:0;
      animation: silIn 1.2s ease .9s forwards;
    }
    @keyframes silIn{ to{opacity:1} }
    .runMan{
      animation: runAcross 4.2s ease-in-out 1.2s forwards;
      transform-origin: center;
    }
    @keyframes runAcross{
      0%{ transform: translateX(-280px) }
      100%{ transform: translateX(120px) }
    }
    .dog{
      animation: dogAcross 4.2s ease-in-out 1.2s forwards;
    }
    @keyframes dogAcross{
      0%{ transform: translateX(-240px) }
      100%{ transform: translateX(90px) }
    }
    .finalText{
      position:absolute;
      left:50%;
      bottom:10%;
      transform:translateX(-50%);
      color: rgba(255,255,255,.92);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:16px;
      letter-spacing:.02em;
      text-align:center;
      opacity:0;
      animation: textIn 1.1s ease 2.4s forwards;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
    }
    @keyframes textIn{ to{opacity:1} }

    /* Accessibility */
    .sr{position:absolute; left:-9999px}
  </style>
</head>
<body>
  <div class="desktop">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="name">Yuki.co</div>
        <div class="sub">Network Operations</div>
      </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar" aria-hidden="true">
      <div class="tbIcon" title="Start">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
          <path d="M3 3h8v8H3V3Zm10 0h8v8h-8V3ZM3 13h8v8H3v-8Zm10 0h8v8h-8v-8Z" stroke="rgba(255,255,255,.86)" stroke-width="1.7"/>
        </svg>
      </div>
      <div class="tbIcon" title="Search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
          <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="rgba(255,255,255,.86)" stroke-width="1.7"/>
          <path d="M16.8 16.8 21 21" stroke="rgba(255,255,255,.86)" stroke-width="1.7" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="tbIcon" title="Outlook">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
          <path d="M4 7.5h12.5v11H4v-11Z" stroke="rgba(255,255,255,.86)" stroke-width="1.7"/>
          <path d="M16.5 9 20 7.5v11l-3.5-1.5V9Z" stroke="rgba(255,255,255,.86)" stroke-width="1.7"/>
          <path d="M4 8l6.25 5L16.5 8" stroke="rgba(255,255,255,.86)" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="tbSep"></div>
      <div class="tbIcon" title="Terminal">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
          <path d="M4 6h16v12H4V6Z" stroke="rgba(255,255,255,.86)" stroke-width="1.7"/>
          <path d="M7 9l3 3-3 3" stroke="rgba(255,255,255,.86)" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 15h5" stroke="rgba(255,255,255,.86)" stroke-width="1.7" stroke-linecap="round"/>
        </svg>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast" role="button" tabindex="0" aria-label="New incident email notification">
      <div class="toastRow">
        <div class="toastIcon" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M4 7h16v10H4V7Z" stroke="rgba(255,255,255,.90)" stroke-width="1.7"/>
            <path d="M4 8l8 6 8-6" stroke="rgba(255,255,255,.90)" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div>
          <p class="toastTitle">Outlook ‚Ä¢ New incident</p>
          <p class="toastMeta">
            <b>P1:</b> Traffic from <b>Nikkkuuuu</b> to <b>Siva</b> is <b>NOT REACHABLE</b> (TCP/443) ‚Äî click to open.
          </p>
          <span class="toastHint">Click to open email (enables sound)</span>
        </div>
      </div>
    </div>

    <!-- Outlook overlay -->
    <div class="overlay" id="overlay" aria-hidden="true">
      <div class="mailWin" role="dialog" aria-modal="true" aria-label="Outlook email">
        <div class="winHead">
          <div class="winDots" aria-hidden="true">
            <span class="winDot r"></span><span class="winDot y"></span><span class="winDot g"></span>
          </div>
          <div class="winTitle">
            Outlook ‚Äî Incident Mail
            <span class="pill">P1</span>
          </div>
          <button class="closeBtn" id="closeMail" title="Close">‚úï</button>
        </div>

        <div class="mailBody">
          <div class="leftPane">
            <div class="folder"><span>Inbox</span><b>1</b></div>
            <div class="folder"><span>Incidents</span><b>1</b></div>
            <div class="folder"><span>Sent</span><b>0</b></div>
            <div class="folder"><span>Drafts</span><b>0</b></div>
            <div class="folder"><span>Archive</span><b>0</b></div>
          </div>

          <div class="mailPane">
            <div class="mailHdr">
              <div>
                <h2 class="mailSubj">INCIDENT: Traffic not reachable (Nikkkuuuu ‚Üí Siva)</h2>
                <p class="mailFrom">
                  From: <b>noc@yuki.co</b><br/>
                  To: <b>Nikkkuuuu</b><br/>
                  Time: <b id="mailTime"></b>
                </p>
              </div>
              <div class="chip">Impact: Heartbeat latency rising ‚Ä¢ SLA breach risk</div>
            </div>

            <div class="kv">
              <div><b>Incident ID:</b> VAL-0214</div>
              <div><b>Service:</b> Secure Love Delivery</div>
              <div><b>Source:</b> Nikkkuuuu (Client)</div>
              <div><b>Destination:</b> Siva (Heart Domain)</div>
              <div><b>Protocol:</b> TCP/443</div>
              <div><b>Suspected path:</b> Switch ‚Üí Firewall ‚Üí ISE ‚Üí VPN</div>
              <div style="margin-top:8px"><b>Request:</b> Assign this ticket to your name to start the trace.</div>
            </div>

            <div class="assignRow">
              <button class="btn btnYes" id="assignYes">‚úÖ Yes, assign to me</button>

              <div class="noWrap" aria-hidden="false">
                <button class="btn btnNo" id="assignNo">‚ùå No</button>
              </div>

              <div class="attempts" id="attempts"></div>
            </div>

            <div class="kv" style="margin-top:12px; color:rgba(255,255,255,.78)">
              <b>Note:</b> Choosing ‚ÄúNo‚Äù is not recommended. The network (and Siva) will remember.
            </div>

            <div class="sr" id="soundNote">
              Sound will only play after user interaction on many mobile browsers.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Terminal / cinematic debug -->
    <div class="termWin" id="termWin" role="dialog" aria-modal="true" aria-label="Incident terminal">
      <div class="termHead">
        <div class="left">
          <span style="display:inline-flex; gap:8px; align-items:center">
            <span style="width:10px;height:10px;border-radius:50%;background:var(--green);display:inline-block"></span>
            Yuki.co Incident Console
          </span>
          <span style="color:rgba(255,255,255,.65); font-weight:600" id="devLabel">WAITING</span>
        </div>
        <div class="right">
          <button class="hintBtn" id="hintBtn">Hints</button>
          <span id="soundStatus">üîá Sound</span>
        </div>
      </div>

      <div class="hintPanel" id="hintPanel">
        <h4>Next hint</h4>
        <p id="hintText">‚Äî</p>
      </div>

      <div class="termBody">
        <div class="screen" id="screen"></div>
        <div class="inputBar">
          <input class="cmdInput" id="cmdInput" placeholder="Type a command‚Ä¶ (press Enter)" autocomplete="off" />
          <button class="runBtn" id="runBtn">Run</button>
        </div>
      </div>
    </div>

    <!-- Ending -->
    <div class="ending" id="ending" aria-hidden="true">
      <div class="fade"></div>

      <svg class="sil" viewBox="0 0 900 300" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- Ground -->
        <path d="M40 250 C 220 230, 320 260, 460 250 C 600 240, 740 260, 860 250" stroke="rgba(255,255,255,.22)" stroke-width="4" stroke-linecap="round"/>
        <!-- Woman (right) -->
        <g opacity="0.92">
          <circle cx="745" cy="145" r="18" fill="rgba(255,255,255,.88)"/>
          <path d="M735 164 C 730 200, 725 210, 714 238 C 706 258, 726 265, 736 246 C 744 230, 748 212, 750 198 C 754 212, 758 230, 766 246 C 776 265, 796 258, 788 238 C 777 210, 772 200, 767 164 Z" fill="rgba(255,255,255,.88)"/>
          <path d="M732 182 C 710 196, 700 206, 692 218" stroke="rgba(255,255,255,.78)" stroke-width="10" stroke-linecap="round"/>
          <path d="M768 182 C 790 196, 800 206, 808 218" stroke="rgba(255,255,255,.78)" stroke-width="10" stroke-linecap="round"/>
        </g>

        <!-- Man + leash (animated group) -->
        <g class="runMan" opacity="0.92">
          <circle cx="260" cy="150" r="18" fill="rgba(255,255,255,.90)"/>
          <path d="M250 168 C 245 200, 240 210, 230 236 C 222 256, 242 264, 252 246 C 260 230, 264 212, 266 198 C 270 212, 274 230, 282 246 C 292 264, 312 256, 304 236 C 294 210, 289 200, 284 168 Z" fill="rgba(255,255,255,.90)"/>
          <!-- arm with leash -->
          <path d="M244 190 C 220 205, 210 220, 202 235" stroke="rgba(255,255,255,.78)" stroke-width="10" stroke-linecap="round"/>
          <path d="M202 235 C 188 248, 176 256, 160 260" stroke="rgba(255,255,255,.42)" stroke-width="4" stroke-linecap="round"/>
        </g>

        <!-- Dog (animated group) -->
        <g class="dog" opacity="0.92">
          <path d="M150 245 C 144 238, 144 230, 150 224 C 158 216, 172 216, 180 224 C 188 232, 188 244, 180 252 C 172 260, 158 260, 150 252 Z" fill="rgba(255,255,255,.88)"/>
          <path d="M178 226 C 190 222, 198 228, 204 236 C 210 244, 210 252, 204 258" stroke="rgba(255,255,255,.70)" stroke-width="8" stroke-linecap="round"/>
          <path d="M156 224 C 152 214, 142 210, 134 214" stroke="rgba(255,255,255,.70)" stroke-width="8" stroke-linecap="round"/>
          <path d="M164 252 C 160 266, 154 272, 146 272" stroke="rgba(255,255,255,.55)" stroke-width="6" stroke-linecap="round"/>
        </g>
      </svg>

      <div class="finalText">Payload delivered: ‚ÄúI love you, my forever Valentine, Nikkkuuuu.‚Äù üíñ</div>
    </div>
  </div>

  <script>
    (() => {
      // --------- Sound (WebAudio: works after user gesture) ----------
      let audioCtx = null;
      let soundEnabled = false;

      function ensureAudio(){
        if (!audioCtx){
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        if (audioCtx.state === "suspended") audioCtx.resume();
        soundEnabled = true;
        document.getElementById("soundStatus").textContent = "üîä Sound";
      }

      function beep(freq=740, dur=0.08, type="sine", gain=0.05){
        if (!soundEnabled) return;
        const ctx = audioCtx;
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = type;
        o.frequency.value = freq;
        g.gain.value = gain;
        o.connect(g);
        g.connect(ctx.destination);
        o.start();
        o.stop(ctx.currentTime + dur);
      }
      function notifSound(){
        // Outlook-ish: two quick tones
        beep(880, 0.07, "sine", 0.05);
        setTimeout(()=>beep(660, 0.09, "sine", 0.05), 90);
      }
      function errorSound(){
        beep(220, 0.10, "square", 0.04);
        setTimeout(()=>beep(180, 0.12, "square", 0.04), 110);
      }
      function okSound(){
        beep(523.25, 0.06, "sine", 0.05);
        setTimeout(()=>beep(783.99, 0.09, "sine", 0.05), 80);
      }

      // --------- UI refs ----------
      const toast = document.getElementById("toast");
      const overlay = document.getElementById("overlay");
      const closeMail = document.getElementById("closeMail");
      const assignYes = document.getElementById("assignYes");
      const assignNo = document.getElementById("assignNo");
      const attemptsEl = document.getElementById("attempts");
      const mailTime = document.getElementById("mailTime");

      const termWin = document.getElementById("termWin");
      const screen = document.getElementById("screen");
      const cmdInput = document.getElementById("cmdInput");
      const runBtn = document.getElementById("runBtn");
      const devLabel = document.getElementById("devLabel");

      const hintBtn = document.getElementById("hintBtn");
      const hintPanel = document.getElementById("hintPanel");
      const hintText = document.getElementById("hintText");

      const ending = document.getElementById("ending");

      // --------- State ----------
      const st = {
        ticketAssigned:false,
        noTries:0,
        phase:"pre", // pre, sw, fw, ise, vpn, done
        fixedVlan:false,
        fixedAcl:false,
        fixedIse:false,
        fixedVpn:false
      };

      // --------- Terminal helpers ----------
      function tLine(text, cls="tDim"){
        const p = document.createElement("p");
        p.className = `line ${cls}`;
        p.textContent = text;
        screen.appendChild(p);
        screen.scrollTop = screen.scrollHeight;
      }
      function prompt(){
        if (st.phase === "sw") return "SW-CORE-01#";
        if (st.phase === "fw") return "FW-EDGE-01#";
        if (st.phase === "ise") return "ISE-PSN-01#";
        if (st.phase === "vpn") return "VPN-GW-01#";
        if (st.phase === "done") return "CHANGE-MGR#";
        return "YUKI-NOC#";
      }
      function cmdEcho(cmd){
        tLine(`${prompt()} ${cmd}`, "tCmd");
      }
      function setDev(label){
        devLabel.textContent = "‚Ä¢ " + label;
      }

      // Hints are ONLY shown when he clicks Hints
      let hintOpen = false;
      hintBtn.addEventListener("click", () => {
        hintOpen = !hintOpen;
        hintPanel.style.display = hintOpen ? "block" : "none";
      });
      function setHint(msg){
        hintText.textContent = msg;
      }

      // --------- Show toast after short cinematic delay ----------
      function boot(){
        const now = new Date();
        mailTime.textContent = now.toLocaleString();

        setTimeout(() => {
          toast.style.display = "block";
          // Can't autoplay sound on many devices; plays after user clicks toast (we'll also attempt here if allowed)
        }, 900);
      }

      // Toast click opens mail + enables sound
      function openMail(){
        ensureAudio();
        notifSound();
        overlay.style.display = "block";
        overlay.setAttribute("aria-hidden", "false");
      }
      toast.addEventListener("click", openMail);
      toast.addEventListener("keydown", (e)=>{ if(e.key==="Enter") openMail(); });

      closeMail.addEventListener("click", () => {
        overlay.style.display = "none";
        overlay.setAttribute("aria-hidden", "true");
      });

      // --------- NO button dodge (far enough) ----------
      function dodgeNo(){
        ensureAudio();
        st.noTries++;
        errorSound();

        const wrap = assignNo.parentElement;
        const w = wrap.clientWidth;
        const h = wrap.clientHeight;

        // Large movements: jump across the row area, not tiny wiggles
        const bigX = (Math.random() < 0.5 ? -1 : 1) * (120 + Math.random()*140);
        const bigY = (Math.random() < 0.5 ? -1 : 1) * (18 + Math.random()*26);

        assignNo.style.transform = `translate(${bigX}px, ${bigY}px)`;

        attemptsEl.textContent = `Nice try. You can‚Äôt get me. (${st.noTries}/5)`;

        if (st.noTries >= 5){
          // Disappear dramatically
          assignNo.style.display = "none";
          attemptsEl.textContent = "No option removed ‚úÖ Now click YES.";
          okSound();
        }
      }
      assignNo.addEventListener("mouseenter", dodgeNo);
      assignNo.addEventListener("click", (e)=>{ e.preventDefault(); dodgeNo(); });
      assignNo.addEventListener("touchstart", (e)=>{ e.preventDefault(); dodgeNo(); }, {passive:false});

      // --------- Assign YES starts terminal ----------
      assignYes.addEventListener("click", () => {
        ensureAudio();
        okSound();

        st.ticketAssigned = true;
        overlay.style.display = "none";
        overlay.setAttribute("aria-hidden", "true");

        // show terminal seamlessly
        termWin.style.display = "block";
        setDev("INCIDENT VAL-0214 ‚Ä¢ Trace started");

        // cinematic intro in terminal
        tLine("üåå OPERATION: SECURE THE HEART üåå", "tInfo");
        tLine("P1 Incident: Traffic NOT REACHABLE (Nikkkuuuu ‚Üí Siva) over TCP/443", "tWarn");
        tLine("Objective: Trace path and restore secure delivery.", "tDim");
        tLine("Path: Switch ‚Üí Firewall ‚Üí ISE ‚Üí VPN ‚Üí Delivery", "tDim");
        tLine("", "tDim");
        tLine("Enter privileged mode to begin.", "tDim");
        tLine("Type: enable", "tOk");
        setHint("Type: enable");
        cmdInput.focus();
      });

      // --------- Command engine (no quick commands) ----------
      function norm(s){ return (s||"").trim().toLowerCase().replace(/\s+/g," "); }

      function requirePhase(phase){
        if (st.phase !== phase){
          if (st.phase === "pre"){
            tLine("You are not in privileged mode yet. Type: enable", "tWarn");
            setHint("Type: enable");
          } else {
            tLine("Command rejected: wrong device context. Follow the trace.", "tWarn");
            setHint(nextHint());
          }
          errorSound();
          return false;
        }
        return true;
      }

      function nextHint(){
        if (st.phase === "pre") return "Type: enable";
        if (st.phase === "sw"){
          if (!st.fixedVlan) return "Switch: show interface status";
          return "Switch cleared. Type: next";
        }
        if (st.phase === "fw"){
          if (!st.fixedAcl) return "Firewall: packet-tracer input inside tcp 10.214.0.10 51432 10.13.0.7 443";
          return "Firewall cleared. Type: next";
        }
        if (st.phase === "ise"){
          if (!st.fixedIse) return "ISE: show live logs";
          return "ISE cleared. Type: next";
        }
        if (st.phase === "vpn"){
          if (!st.fixedVpn) return "VPN: show crypto ikev2 sa";
          return "VPN up. Type: deliver";
        }
        if (st.phase === "done") return "Mission complete.";
        return "‚Äî";
      }

      async function exec(cmdRaw){
        const cmd = cmdRaw.trim();
        const c = norm(cmdRaw);

        if (!cmd) return;

        cmdEcho(cmd);
        ensureAudio(); // allow sound after first interaction

        // PRE / enable
        if (st.phase === "pre"){
          if (c === "enable"){
            okSound();
            tLine("Entering privileged mode‚Ä¶", "tDim");
            tLine("Access granted: role=NetworkSecurity | clearance=LOVE-PRIME", "tOk");
            st.phase = "sw";
            setDev("SW-CORE-01 ‚Ä¢ Access Layer");
            tLine("", "tDim");
            tLine("=== HOP 1/4: SWITCH ===", "tInfo");
            tLine("Symptom: Love packets quarantined at access layer.", "tWarn");
            tLine("Run a standard check.", "tDim");
            setHint(nextHint());
            return;
          }
          errorSound();
          tLine("Access denied. Type: enable", "tWarn");
          setHint(nextHint());
          return;
        }

        // SWITCH
        if (st.phase === "sw"){
          if (c === "show interface status"){
            tLine("Port      Name               Status       Vlan       Duplex Speed Type", "tDim");
            if (!st.fixedVlan){
              tLine("Gi1/0/24  NIKK-CLIENT         connected    999        a-full a-100 10/100/1000-TX", "tWarn");
              tLine("% Notice: VLAN mismatch. Expected 214 (VALENTINE). Found 999 (QUARANTINE).", "tBad");
              errorSound();
              setHint("Fix: conf t ; interface gi1/0/24 ; switchport access vlan 214 ; end ; wr mem");
            } else {
              tLine("Gi1/0/24  NIKK-CLIENT         connected    214        a-full a-100 10/100/1000-TX", "tOk");
              tLine("‚úÖ Access VLAN correct.", "tOk");
              okSound();
              setHint(nextHint());
            }
            return;
          }

          if (c === "show interfaces gi1/0/24 switchport" || c === "show interfaces gi1/0/24 switchport"){
            if (!st.fixedVlan){
              tLine("Name: Gi1/0/24", "tDim");
              tLine("Administrative Mode: static access", "tDim");
              tLine("Operational Mode: static access", "tDim");
              tLine("Access Mode VLAN: 999 (QUARANTINE)", "tBad");
              errorSound();
              setHint("Fix: conf t ; interface gi1/0/24 ; switchport access vlan 214 ; end ; wr mem");
            } else {
              tLine("Name: Gi1/0/24", "tDim");
              tLine("Access Mode VLAN: 214 (VALENTINE)", "tOk");
              okSound();
              setHint(nextHint());
            }
            return;
          }

          if (c.includes("switchport access vlan 214")){
            // accept any conf t chain containing this
            if (!st.fixedVlan){
              tLine("Enter configuration commands, one per line. End with CNTL/Z.", "tDim");
              tLine("SW-CORE-01(config)# interface Gi1/0/24", "tDim");
              tLine("SW-CORE-01(config-if)# switchport access vlan 214", "tOk");
              tLine("SW-CORE-01(config-if)# end", "tDim");
              tLine("SW-CORE-01# write memory", "tDim");
              tLine("Building configuration... [OK]", "tOk");
              st.fixedVlan = true;
              okSound();
              tLine("‚úÖ Switch fix applied. Packets can exit access layer.", "tOk");
              setHint("Type: next");
            } else {
              tLine("No changes required. VLAN already 214.", "tDim");
              setHint(nextHint());
            }
            return;
          }

          if (c === "next"){
            if (!st.fixedVlan){
              tLine("BLOCKED: still quarantined. Fix VLAN first.", "tWarn");
              errorSound();
              setHint(nextHint());
              return;
            }
            okSound();
            st.phase = "fw";
            setDev("FW-EDGE-01 ‚Ä¢ Perimeter Firewall");
            tLine("", "tDim");
            tLine("=== HOP 2/4: FIREWALL ===", "tInfo");
            tLine("Symptom: TCP/443 drops observed at edge.", "tWarn");
            setHint(nextHint());
            return;
          }

          // wrong command
          errorSound();
          tLine("Unrecognized command in this context.", "tWarn");
          setHint(nextHint());
          return;
        }

        // FIREWALL
        if (st.phase === "fw"){
          if (c === "show access-list"){
            tLine("access-list OUTSIDE-IN; 4 elements", "tDim");
            if (!st.fixedAcl){
              tLine("1: deny tcp any host 10.13.0.7 eq 443 (hitcnt=57)", "tBad");
              tLine("2: permit tcp host 10.214.0.10 any eq 22 (hitcnt=3)", "tDim");
              tLine("3: permit icmp any any (hitcnt=19)", "tDim");
              tLine("4: deny ip any any (hitcnt=1200)", "tDim");
              tLine("% Result: love packets dropped by OUTSIDE-IN line 1", "tBad");
              errorSound();
              setHint("Run: packet-tracer input inside tcp 10.214.0.10 51432 10.13.0.7 443");
            } else {
              tLine("1: permit tcp host 10.214.0.10 host 10.13.0.7 eq 443 (hitcnt=14)", "tOk");
              tLine("2: deny ip any any (hitcnt=1200)", "tDim");
              okSound();
              setHint(nextHint());
            }
            return;
          }

          if (c.startsWith("packet-tracer")){
            if (!st.fixedAcl){
              tLine("Phase: 1  ROUTE-LOOKUP  Result: ALLOW", "tDim");
              tLine("Phase: 2  ACCESS-LIST   Result: DROP", "tBad");
              tLine("Drop-reason: (acl-drop) OUTSIDE-IN deny tcp any host 10.13.0.7 eq 443", "tBad");
              errorSound();
              setHint("Fix: access-list OUTSIDE-IN extended permit tcp host 10.214.0.10 host 10.13.0.7 eq 443");
            } else {
              tLine("Phase: 1  ROUTE-LOOKUP  Result: ALLOW", "tDim");
              tLine("Phase: 2  ACCESS-LIST   Result: ALLOW", "tOk");
              tLine("Result: ALLOW", "tOk");
              okSound();
              setHint(nextHint());
            }
            return;
          }

          if (c.startsWith("access-list outside-in extended permit tcp")){
            if (!st.fixedAcl){
              tLine("Applied: OUTSIDE-IN permit tcp host 10.214.0.10 host 10.13.0.7 eq 443", "tOk");
              tLine("Write mem‚Ä¶ done", "tOk");
              st.fixedAcl = true;
              okSound();
              tLine("‚úÖ Firewall fix applied. 443 is now permitted.", "tOk");
              setHint("Type: next");
            } else {
              tLine("Rule already present.", "tDim");
              setHint(nextHint());
            }
            return;
          }

          if (c === "next"){
            if (!st.fixedAcl){
              tLine("BLOCKED: firewall still dropping 443. Fix ACL first.", "tWarn");
              errorSound();
              setHint(nextHint());
              return;
            }
            okSound();
            st.phase = "ise";
            setDev("ISE-PSN-01 ‚Ä¢ Policy Enforcement");
            tLine("", "tDim");
            tLine("=== HOP 3/4: ISE ===", "tInfo");
            tLine("Symptom: authorization failure suspected.", "tWarn");
            setHint(nextHint());
            return;
          }

          errorSound();
          tLine("Unrecognized command in this context.", "tWarn");
          setHint(nextHint());
          return;
        }

        // ISE
        if (st.phase === "ise"){
          if (c === "show live logs" || c === "show live log" || c === "show logs"){
            if (!st.fixedIse){
              tLine("Timestamp            User        Result      Reason", "tDim");
              tLine("2026-02-14 23:59:12  nikkkuuuu   REJECT      15039 Authorization Profile ACCESS_REJECT", "tBad");
              tLine("2026-02-14 23:59:14  nikkkuuuu   REJECT      15039 Authorization Profile ACCESS_REJECT", "tBad");
              errorSound();
              setHint("Fix: apply profile VALENTINE_PERMIT for user nikkkuuuu (type: fix ise)");
            } else {
              tLine("Timestamp            User        Result      Profile", "tDim");
              tLine("2026-02-14 23:59:42  nikkkuuuu   ACCEPT      VALENTINE_PERMIT", "tOk");
              okSound();
              setHint(nextHint());
            }
            return;
          }

          if (c === "show authentication status"){
            if (!st.fixedIse){
              tLine("User: nikkkuuuu", "tDim");
              tLine("Status: REJECTED", "tBad");
              tLine("AuthZ: ACCESS_REJECT", "tBad");
              errorSound();
              setHint("Type: fix ise");
            } else {
              tLine("User: nikkkuuuu", "tDim");
              tLine("Status: AUTHORIZED", "tOk");
              tLine("AuthZ: VALENTINE_PERMIT", "tOk");
              okSound();
              setHint(nextHint());
            }
            return;
          }

          if (c === "fix ise"){
            if (!st.fixedIse){
              tLine("Updating policy set‚Ä¶", "tDim");
              tLine("Rule match: user=nikkkuuuu ‚Üí Authorization Profile=VALENTINE_PERMIT", "tOk");
              tLine("Policy distribution‚Ä¶ OK", "tOk");
              st.fixedIse = true;
              okSound();
              tLine("‚úÖ ISE fix applied. Authorization now permits the flow.", "tOk");
              setHint("Type: next");
            } else {
              tLine("No changes required.", "tDim");
              setHint(nextHint());
            }
            return;
          }

          if (c === "next"){
            if (!st.fixedIse){
              tLine("BLOCKED: ISE still rejecting. Fix policy first.", "tWarn");
              errorSound();
              setHint(nextHint());
              return;
            }
            okSound();
            st.phase = "vpn";
            setDev("VPN-GW-01 ‚Ä¢ Tunnel Gateway");
            tLine("", "tDim");
            tLine("=== HOP 4/4: VPN ===", "tInfo");
            tLine("Symptom: tunnel not established / SAs missing.", "tWarn");
            setHint(nextHint());
            return;
          }

          errorSound();
          tLine("Unrecognized command in this context.", "tWarn");
          setHint(nextHint());
          return;
        }

        // VPN
        if (st.phase === "vpn"){
          if (c === "show crypto ikev2 sa"){
            if (!st.fixedVpn){
              tLine("IPv4 Crypto IKEv2  SA", "tDim");
              tLine("Tunnel-id Local               Remote              Status", "tDim");
              tLine("0        10.0.0.1:500         10.0.0.2:500         DOWN", "tBad");
              tLine("% No active IKEv2 SAs. Rekey required.", "tBad");
              errorSound();
              setHint("Type: fix vpn");
            } else {
              tLine("Tunnel-id Local               Remote              Status", "tDim");
              tLine("7        10.0.0.1:500         10.0.0.2:500         UP-ACTIVE", "tOk");
              tLine("Encryption: AES-256  Integrity: SHA256  DPD: enabled", "tOk");
              okSound();
              setHint("Type: deliver");
            }
            return;
          }

          if (c === "show crypto ipsec sa"){
            if (!st.fixedVpn){
              tLine("pkts encaps: 0, pkts decaps: 0", "tBad");
              tLine("% IPsec SA not installed (IKEv2 down)", "tBad");
              errorSound();
              setHint("Type: fix vpn");
            } else {
              tLine("pkts encaps: 18, pkts decaps: 18", "tOk");
              tLine("anti-replay: enabled", "tDim");
              okSound();
              setHint("Type: deliver");
            }
            return;
          }

          if (c === "fix vpn"){
            if (!st.fixedVpn){
              tLine("Initiating rekey‚Ä¶", "tDim");
              tLine("IKE_SA_INIT‚Ä¶ OK", "tOk");
              tLine("IKE_AUTH‚Ä¶ OK", "tOk");
              tLine("Installing CHILD_SA‚Ä¶ OK", "tOk");
              st.fixedVpn = true;
              okSound();
              tLine("‚úÖ Tunnel established. Traffic can cross securely.", "tOk");
              setHint("Type: deliver");
            } else {
              tLine("Tunnel already up.", "tDim");
              setHint(nextHint());
            }
            return;
          }

          if (c === "deliver"){
            if (!st.fixedVpn){
              tLine("BLOCKED: tunnel still down.", "tWarn");
              errorSound();
              setHint(nextHint());
              return;
            }
            st.phase = "done";
            setDev("CHANGE-MGR ‚Ä¢ Payload Delivery");
            okSound();
            tLine("", "tDim");
            tLine("=== DELIVERY ===", "tInfo");
            tLine("Capturing TCP/443‚Ä¶", "tDim");
            tLine("Frames: 18  Drops: 0  Latency: 0ms", "tOk");
            tLine("Payload delivered:", "tDim");
            tLine("‚ÄúI love you, my forever Valentine, Nikkkuuuu.‚Äù üíñ", "tOk");
            tLine("", "tDim");
            tLine("Mission complete.", "tOk");

            // cinematic ending transition
            setTimeout(() => {
              termWin.style.display = "none";
              startEnding();
            }, 1400);
            return;
          }

          errorSound();
          tLine("Unrecognized command in this context.", "tWarn");
          setHint(nextHint());
          return;
        }

        // DONE
        if (st.phase === "done"){
          tLine("Mission already complete.", "tDim");
          return;
        }
      }

      // --------- Ending scene ----------
      function startEnding(){
        ending.style.display = "block";
        // soft final tone
        okSound();
      }

      // Run handlers
      function runFromUI(){
        const v = cmdInput.value;
        cmdInput.value = "";
        exec(v);
      }
      runBtn.addEventListener("click", runFromUI);
      cmdInput.addEventListener("keydown", (e)=>{ if(e.key==="Enter") runFromUI(); });

      // Start with toast
      boot();
    })();
  </script>
</body>
</html>
