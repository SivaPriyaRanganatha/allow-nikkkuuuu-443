
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Yuki.co ‚Ä¢ Incident Console</title>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    :root{
      --bg1:#071427;
      --bg2:#0a1b32;
      --stroke: rgba(255,255,255,.18);
      --shadow: 0 18px 70px rgba(0,0,0,.48);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --green:#00ff9d;
      --yellow:#ffd86b;
      --red:#ff5c7a;
      --blue:#7dd3fc;
      --pink:#ff3b7a;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      overflow:hidden;
      background:
        radial-gradient(1200px 700px at 70% 10%, rgba(125,211,252,.16), transparent 60%),
        radial-gradient(1100px 700px at 20% 20%, rgba(0,255,157,.12), transparent 60%),
        radial-gradient(900px 700px at 50% 90%, rgba(255,92,122,.14), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
    }

    .wallpaper{ position:fixed; inset:0; pointer-events:none; opacity:.95; z-index:0; }
    .wallpaper::before{
      content:"";
      position:absolute; inset:-220px;
      background:
        radial-gradient(circle at 18% 22%, rgba(255,92,122,.25) 0 2px, transparent 3px) 0 0/88px 88px,
        radial-gradient(circle at 75% 44%, rgba(255,216,107,.18) 0 2px, transparent 3px) 0 0/112px 112px,
        radial-gradient(circle at 42% 78%, rgba(255,255,255,.10) 0 2px, transparent 3px) 0 0/126px 126px;
      opacity:.7;
      animation: drift 12s ease-in-out infinite alternate;
    }
    @keyframes drift{
      from{ transform: translate3d(-14px,-10px,0) }
      to{ transform: translate3d(14px,10px,0) }
    }
    .watermark{
      position:fixed; inset:0; pointer-events:none;
      display:grid; place-items:center;
      opacity:.12;
      font-weight:900;
      letter-spacing:.06em;
      font-size: clamp(56px, 10vw, 150px);
      text-transform:uppercase;
      color:rgba(255,255,255,.86);
      text-shadow: 0 18px 60px rgba(0,0,0,.35);
      mix-blend-mode: overlay;
      user-select:none;
      z-index:1;
    }

    .desktop{ position:relative; height:100%; padding:18px; z-index:2; }

    .brand{
      position:absolute; left:18px; top:14px;
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.08);
      border-radius:14px;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      user-select:none;
      z-index:5;
    }
    .brand .logo{
      width:34px; height:34px; border-radius:12px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(0,255,157,.95), transparent 70%),
        radial-gradient(20px 20px at 70% 70%, rgba(125,211,252,.85), transparent 70%),
        radial-gradient(18px 18px at 80% 30%, rgba(255,216,107,.75), transparent 70%),
        rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
    }
    .brand .name{ font-weight:900; letter-spacing:.02em; line-height:1.05; }
    .brand .sub{ font-size:12px; color:var(--muted); letter-spacing:.06em; text-transform:uppercase; }

    .taskbar{
      position:absolute; left:50%; bottom:14px; transform:translateX(-50%);
      width:min(760px, calc(100% - 28px));
      height:56px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      padding:10px 14px;
      z-index:5;
    }
    .tbIcon{
      width:36px; height:36px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.10);
      display:grid; place-items:center;
      user-select:none;
      position:relative;
    }
    .tbSep{width:1px; height:28px; background: rgba(255,255,255,.14); margin:0 4px}

    /* Teams icon state */
    .teamsIcon{
      border-color: rgba(255,255,255,.18);
    }
    .teamsIcon.blink{
      animation: blinkTeams 0.9s ease-in-out infinite;
      border-color: rgba(255,59,122,.55);
      box-shadow: 0 0 0 6px rgba(255,59,122,.10);
    }
    @keyframes blinkTeams{
      0%,100%{ transform: translateY(0); filter: brightness(1); }
      50%{ transform: translateY(-1px); filter: brightness(1.25); }
    }
    .badge{
      position:absolute;
      top:-6px; right:-6px;
      min-width:20px; height:20px;
      border-radius:999px;
      padding:0 6px;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(255,59,122,.95);
      border:1px solid rgba(255,255,255,.25);
      color:white;
      font-size:12px;
      font-weight:900;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .toast{
      position:absolute; right:18px; bottom:86px;
      width:min(420px, calc(100% - 36px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      padding:12px;
      display:none;
      cursor:pointer;
      transform: translateY(24px);
      opacity:0;
      animation: toastIn .55s ease forwards;
      z-index:9999;
    }
    @keyframes toastIn{ to{ transform:translateY(0); opacity:1; } }
    .toastRow{display:flex; gap:10px; align-items:flex-start}
    .toastIcon{
      width:38px; height:38px; border-radius:14px;
      background: rgba(125,211,252,.16);
      border:1px solid rgba(125,211,252,.25);
      display:grid; place-items:center;
      flex:0 0 auto;
    }
    .toastTitle{ font-weight:900; margin:0; font-size:14px; }
    .toastMeta{ margin:2px 0 0 0; color:var(--muted); font-size:12px; line-height:1.35; }
    .toastHint{
      margin:8px 0 0 0;
      color:rgba(255,255,255,.84);
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      display:inline-block;
    }

    .overlay{ position:absolute; inset:0; background: rgba(0,0,0,.35); display:none; z-index:50; }
    .mailWin{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width:min(920px, calc(100% - 28px));
      height:min(560px, calc(100% - 140px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .winHead{
      height:46px; display:flex; align-items:center; justify-content:space-between;
      padding:0 12px;
      border-bottom:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
    }
    .winDots{display:flex; gap:8px; align-items:center}
    .winDot{width:10px;height:10px;border-radius:50%}
    .winDot.r{background:var(--red)} .winDot.y{background:var(--yellow)} .winDot.g{background:var(--green)}
    .winTitle{ font-weight:900; font-size:13px; color:rgba(255,255,255,.88); display:flex; gap:10px; align-items:center;}
    .pill{
      font-size:11px; padding:4px 8px; border-radius:999px;
      border:1px solid rgba(255,216,107,.25);
      background: rgba(255,216,107,.10);
      color: rgba(255,216,107,.95);
      font-weight:900; letter-spacing:.05em; text-transform:uppercase;
    }
    .closeBtn{
      width:36px; height:30px; border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.85);
      cursor:pointer;
    }
    .mailBody{ display:grid; grid-template-columns: 260px 1fr; height: calc(100% - 46px); }
    @media(max-width:860px){ .mailBody{grid-template-columns:1fr} .leftPane{display:none} }
    .leftPane{ border-right:1px solid rgba(255,255,255,.14); background: rgba(0,0,0,.10); padding:10px; }
    .folder{
      padding:10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      margin-bottom:10px; font-size:13px;
      display:flex; justify-content:space-between; align-items:center;
    }
    .mailPane{ padding:14px; overflow:auto; }
    .mailSubj{ margin:0; font-weight:950; font-size:18px; }
    .mailFrom{ margin:6px 0 0 0; color:var(--muted); font-size:13px; line-height:1.4; }
    .kv{
      margin-top:10px; border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.16);
      padding:12px; font-size:13px; color:rgba(255,255,255,.82);
      line-height:1.55;
    }
    .btn{
      padding:12px 14px; border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:rgba(255,255,255,.92);
      cursor:pointer;
      font-weight:900;
    }
    .btnYes{
      border-color: rgba(0,255,157,.30);
      background: rgba(0,255,157,.14);
      color: rgba(0,255,157,.95);
    }
    .assignRow{ position:relative; min-height:92px; margin-top:14px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .noBtn{
      position:absolute; left:320px; top:10px;
      width:180px;
      border-color: rgba(255,92,122,.40);
      background: rgba(255,92,122,.10);
      color: rgba(255,92,122,.95);
      z-index:5;
    }
    .attempts{ margin-left:auto; color:rgba(255,255,255,.70); font-size:12px; }

    /* Teams chat (only after Assign YES) */
    .chatOverlay{
      position:absolute; inset:0; display:none;
      background: rgba(0,0,0,.18);
      z-index:80;
      pointer-events:none;
    }
    .chatToast{
      position:absolute; right:18px; top:80px;
      width:min(360px, calc(100% - 36px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(25,25,35,.55);
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow);
      overflow:hidden;
      pointer-events:auto;
    }
    .chatHead{
      display:flex; gap:10px; align-items:center;
      padding:12px 12px;
      border-bottom:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
    }
    .avatar{
      width:38px; height:38px; border-radius:14px;
      display:grid; place-items:center;
      font-weight:950;
      background: rgba(255,79,135,.18);
      border:1px solid rgba(255,79,135,.25);
    }
    .chatTitle{ font-weight:950; }
    .chatSub{ font-size:12px; opacity:.75; margin-top:2px; }
    .chatBody{ padding:12px; }
    .bubble{
      max-width:92%;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      margin:0 0 10px 0;
      font-size:13px;
      line-height:1.35;
    }
    .typing{
      display:inline-flex; gap:5px; align-items:center;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      margin:0 0 10px 0;
    }
    .dot{width:6px;height:6px;border-radius:50%;background:rgba(255,255,255,.75);animation: bounce .9s infinite}
    .dot:nth-child(2){animation-delay:.12s}
    .dot:nth-child(3){animation-delay:.24s}
    @keyframes bounce{ 0%,80%,100%{transform:translateY(0);opacity:.55} 40%{transform:translateY(-4px);opacity:1} }

    .chatMin{
      margin-left:auto;
      width:34px;height:30px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.85);
      cursor:pointer;
      font-weight:900;
    }

    /* Terminal */
    .termWin{
      position:absolute;
      left:50%; top:52%;
      transform:translate(-50%,-50%);
      width:min(1040px, calc(100% - 28px));
      height:min(680px, calc(100% - 130px));
      border-radius:22px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.26);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      display:none;
      z-index:70;
      overflow:hidden;
    }
    .termHead{
      height:50px;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 14px;
      border-bottom:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.07);
    }
    .termHead .left{
      display:flex; align-items:center; gap:10px;
      font-size:13px; font-weight:900;
      color:rgba(255,255,255,.86);
    }
    .termHead .right{
      display:flex; align-items:center; gap:10px;
      z-index:3;
    }
    .hintBtnTop{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
      cursor:pointer;
      font-weight:950;
    }
    .screen{
      padding:16px 16px 8px;
      overflow:auto;
      height: calc(100% - 70px);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:14px;
      line-height:1.55;
      color: rgba(184,255,217,.92);
      white-space:pre-wrap;
    }
    .line{margin:0 0 6px 0}
    .tDim{color: rgba(184,255,217,.70)}
    .tOk{color: var(--green)}
    .tWarn{color: var(--yellow)}
    .tBad{color: var(--red)}
    .tInfo{color: var(--blue)}
    .tCmd{color: rgba(255,255,255,.92)}

    .inputBar{
      display:flex; gap:10px; align-items:center;
      padding:10px 12px;
      border-top:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      height:70px;
    }
    .cmdInput{
      flex:1;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: rgba(184,255,217,.95);
      padding:14px 14px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:14px;
      outline:none;
    }
    .cmdInput::placeholder{color: rgba(184,255,217,.45)}
    .runBtn{
      padding:14px 16px;
      border-radius:16px;
      border:0;
      background: linear-gradient(135deg, rgba(0,255,157,.22), rgba(125,211,252,.16));
      color: rgba(255,255,255,.95);
      cursor:pointer;
      font-weight:950;
      min-width:88px;
    }
    .hintBtnRow{
      padding:14px 16px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.95);
      cursor:pointer;
      font-weight:950;
      min-width:96px;
    }
    .hintPanel{
      position:absolute;
      right:14px;
      top:60px;
      width:min(460px, calc(100% - 28px));
      border-radius:18px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.38);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      padding:14px;
      display:none;
      z-index:999;
    }
    .hintPanel h4{
      margin:0 0 8px 0;
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(255,255,255,.86);
    }
    .hintPanel p{
      margin:0;
      font-size:13px;
      color: rgba(255,255,255,.86);
      line-height:1.45;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      white-space:pre-wrap;
    }

    /* Ending */
    .ending{
      position:absolute; inset:0; display:none; z-index:200; overflow:hidden;
      background:
        radial-gradient(1200px 800px at 30% 30%, rgba(255,79,135,.42), transparent 55%),
        radial-gradient(1200px 800px at 70% 70%, rgba(109,40,217,.40), transparent 55%),
        linear-gradient(135deg, #2a0050, #17002a);
    }
    .heartsLayer{ position:absolute; inset:0; pointer-events:none; overflow:hidden; }
    .heart{
      position:absolute;
      font-size: clamp(54px, 6vw, 120px);
      color: rgba(255, 30, 90, .95);
      text-shadow: 0 18px 60px rgba(0,0,0,.40);
      animation: floatUp linear infinite;
      user-select:none;
      will-change: transform, opacity;
      filter: drop-shadow(0 18px 40px rgba(0,0,0,.35));
    }
    @keyframes floatUp{
      0%   { transform: translate3d(0, 120vh, 0) rotate(0deg); opacity:0; }
      10%  { opacity:1; }
      85%  { opacity:1; }
      100% { transform: translate3d(0, -140vh, 0) rotate(18deg); opacity:0; }
    }
    .loveText{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      text-align:center;
      font-weight:950;
      letter-spacing:.02em;
      font-size: clamp(30px, 5vw, 82px);
      color: rgba(255,255,255,.96);
      text-shadow: 0 18px 70px rgba(0,0,0,.55);
      padding: 18px 22px;
      border-radius: 28px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.14);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      line-height: 1.08;
      white-space:pre-wrap;
    }
  </style>
</head>

<body>
  <div class="wallpaper"></div>
  <div class="watermark">YUKI.CO</div>

  <div class="desktop">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="name">Yuki.co</div>
        <div class="sub">Network Operations</div>
      </div>
    </div>

    <div class="taskbar" aria-hidden="true">
      <div class="tbIcon" title="Start"></div>
      <div class="tbIcon" title="Search"></div>
      <div class="tbIcon" title="Outlook"></div>
      <div class="tbSep"></div>

      <!-- Teams icon (blinks while chat waiting / unseen) -->
      <div class="tbIcon teamsIcon" id="teamsIcon" title="Teams">
        <div class="badge" id="teamsBadge">1</div>
      </div>

      <div class="tbIcon" title="Terminal"></div>
    </div>

    <!-- Outlook toast -->
    <div class="toast" id="toast" role="button" tabindex="0">
      <div class="toastRow">
        <div class="toastIcon" aria-hidden="true"></div>
        <div>
          <p class="toastTitle">Outlook ‚Ä¢ New incident</p>
          <p class="toastMeta"><b>P1:</b> Traffic from <b>Nikkkuuuu</b> to <b>Siva</b> is <b>NOT REACHABLE</b> (TCP/443).</p>
          <span class="toastHint">Click to open email</span>
        </div>
      </div>
    </div>

    <!-- Outlook mail -->
    <div class="overlay" id="overlay" aria-hidden="true">
      <div class="mailWin" role="dialog" aria-modal="true">
        <div class="winHead">
          <div class="winDots" aria-hidden="true">
            <span class="winDot r"></span><span class="winDot y"></span><span class="winDot g"></span>
          </div>
          <div class="winTitle">Outlook ‚Äî Incident Mail <span class="pill">P1</span></div>
          <button class="closeBtn" id="closeMail" title="Close">‚úï</button>
        </div>

        <div class="mailBody">
          <div class="leftPane">
            <div class="folder"><span>Inbox</span><b>1</b></div>
            <div class="folder"><span>Incidents</span><b>1</b></div>
            <div class="folder"><span>Sent</span><b>0</b></div>
            <div class="folder"><span>Drafts</span><b>0</b></div>
          </div>

          <div class="mailPane">
            <h2 class="mailSubj">INCIDENT: Traffic not reachable (Nikkkuuuu ‚Üí Siva)</h2>
            <p class="mailFrom">
              From: <b>noc@yuki.co</b><br/>
              To: <b>Nikkkuuuu</b><br/>
              Time: <b id="mailTime"></b>
            </p>

            <div class="kv">
              <div><b>Incident ID:</b> VAL-0214</div>
              <div><b>Source:</b> 10.214.0.10</div>
              <div><b>Destination:</b> 10.13.0.7</div>
              <div><b>Service:</b> TCP/443</div>
              <div><b>Path:</b> Switch ‚Üí Firewall ‚Üí ISE ‚Üí VPN</div>
              <div style="margin-top:10px"><b>Request:</b> Assign this ticket to your name.</div>
            </div>

            <div class="assignRow" id="assignArea">
              <button class="btn btnYes" id="assignYes">‚úÖ Yes, assign to me</button>
              <button class="btn noBtn" id="assignNo">‚ùå No</button>
              <div class="attempts" id="attempts"></div>
            </div>

            <div class="kv"><b>Rule:</b> ‚ÄúNo‚Äù will run away. Catch it 5 times to remove it.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Teams chat (only after Assign YES) -->
    <div class="chatOverlay" id="chatOverlay" aria-hidden="true">
      <div class="chatToast">
        <div class="chatHead">
          <div class="avatar">Y</div>
          <div>
            <div class="chatTitle">Yuki</div>
            <div class="chatSub">CDO ( Chief Dog Officer )</div>
          </div>
          <button class="chatMin" id="chatMin">‚Äî</button>
        </div>
        <div class="chatBody" id="chatBody"></div>
      </div>
    </div>

    <!-- Terminal -->
    <div class="termWin" id="termWin" role="dialog" aria-modal="true">
      <div class="termHead">
        <div class="left">
          <span style="width:10px;height:10px;border-radius:50%;background:var(--green);display:inline-block"></span>
          Yuki.co Incident Console
          <span style="color:rgba(255,255,255,.65);font-weight:800" id="devLabel">‚Ä¢ WAITING</span>
        </div>
        <div class="right">
          <button class="hintBtnTop" id="hintBtnTop">üí° Hints</button>
          <span id="soundStatus" style="color:rgba(255,255,255,.75);font-weight:800">üîá Sound</span>
        </div>
      </div>

      <div class="hintPanel" id="hintPanel">
        <h4>Next hint</h4>
        <p id="hintText">‚Äî</p>
      </div>

      <div class="screen" id="screen"></div>

      <div class="inputBar">
        <input class="cmdInput" id="cmdInput" placeholder="Type a command‚Ä¶ (press Enter)" autocomplete="off" />
        <button class="hintBtnRow" id="hintBtnRow">Hints</button>
        <button class="runBtn" id="runBtn">Run</button>
      </div>
    </div>

    <!-- Ending -->
    <div class="ending" id="ending" aria-hidden="true">
      <div class="heartsLayer" id="heartsLayer"></div>
      <div class="loveText">Nikkuu I love you‚Ä¶
you are my forever valentine. üòòüòò</div>
    </div>
  </div>

  <script>
    (() => {
      // Sound
      let audioCtx = null;
      let soundEnabled = false;

      function ensureAudio(){
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === "suspended") audioCtx.resume();
        soundEnabled = true;
        document.getElementById("soundStatus").textContent = "üîä Sound";
      }
      function beep(freq=740, dur=0.08, type="sine", gain=0.05){
        if (!soundEnabled) return;
        const ctx = audioCtx;
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = type; o.frequency.value = freq; g.gain.value = gain;
        o.connect(g); g.connect(ctx.destination);
        o.start(); o.stop(ctx.currentTime + dur);
      }
      const notifSound = () => { beep(880,0.07,"sine",0.05); setTimeout(()=>beep(660,0.09,"sine",0.05),90); };
      const errorSound = () => { beep(220,0.10,"square",0.04); setTimeout(()=>beep(180,0.12,"square",0.04),110); };
      const okSound    = () => { beep(523.25,0.06,"sine",0.05); setTimeout(()=>beep(783.99,0.09,"sine",0.05),80); };

      // NEW: chat message ping each time
      const chatPing = () => { beep(1046.5,0.06,"sine",0.05); setTimeout(()=>beep(1318.5,0.08,"sine",0.05),70); };

      // UI refs
      const toast = document.getElementById("toast");
      const overlay = document.getElementById("overlay");
      const closeMail = document.getElementById("closeMail");
      const assignYes = document.getElementById("assignYes");
      const assignNo = document.getElementById("assignNo");
      const attemptsEl = document.getElementById("attempts");
      const mailTime = document.getElementById("mailTime");
      const assignArea = document.getElementById("assignArea");

      const chatOverlay = document.getElementById("chatOverlay");
      const chatBody = document.getElementById("chatBody");
      const chatMin = document.getElementById("chatMin");

      const termWin = document.getElementById("termWin");
      const screen = document.getElementById("screen");
      const cmdInput = document.getElementById("cmdInput");
      const runBtn = document.getElementById("runBtn");
      const devLabel = document.getElementById("devLabel");

      const hintBtnTop = document.getElementById("hintBtnTop");
      const hintBtnRow = document.getElementById("hintBtnRow");
      const hintPanel = document.getElementById("hintPanel");
      const hintText = document.getElementById("hintText");

      const ending = document.getElementById("ending");
      const heartsLayer = document.getElementById("heartsLayer");

      // Teams icon controls
      const teamsIcon = document.getElementById("teamsIcon");
      const teamsBadge = document.getElementById("teamsBadge");

      function teamsShowUnread(on){
        if (on){
          teamsIcon.classList.add("blink");
          teamsBadge.style.display = "flex";
        } else {
          teamsIcon.classList.remove("blink");
          teamsBadge.style.display = "none";
        }
      }

      // State
      const st = {
        noTries:0,
        phase:"pre",          // pre -> sw -> fw -> ise -> vpn
        mode:"exec",          // exec | config | config-if
        sw:{ sawStatus:false, vlanSet:false, saved:false },
        fw:{ ranPT:false, aclAdded:false, agApplied:false, saved:false },
        ise:{ sawApp:false, sawLogs:false },
        vpn:{ sawIke:false, cleared:false }
      };

      // Terminal helpers
      function tLine(text, cls="tDim"){
        const p = document.createElement("p");
        p.className = `line ${cls}`;
        p.textContent = text;
        screen.appendChild(p);
        screen.scrollTop = screen.scrollHeight;
      }
      function setDev(label){ devLabel.textContent = "‚Ä¢ " + label; }

      function prompt(){
        if (st.phase==="ise") return "ise/admin#";
        const host =
          st.phase==="sw"  ? "SW-CORE-01" :
          st.phase==="fw"  ? "FW-EDGE-01" :
          st.phase==="vpn" ? "VPN-GW-01" : "YUKI-NOC";

        const suffix =
          st.mode==="exec" ? "#" :
          st.mode==="config" ? "(config)#" :
          st.mode==="config-if" ? "(config-if)#" : "#";

        return `${host}${suffix}`;
      }
      function cmdEcho(cmd){ tLine(`${prompt()} ${cmd}`, "tCmd"); }
      function norm(s){ return (s||"").trim().toLowerCase().replace(/\s+/g," "); }

      // Hints toggle
      let hintOpen = false;
      function toggleHints(){
        hintOpen = !hintOpen;
        hintPanel.style.display = hintOpen ? "block" : "none";
      }
      hintBtnTop.addEventListener("click", toggleHints);
      hintBtnRow.addEventListener("click", toggleHints);
      function setHint(msg){ hintText.textContent = msg; }

      // UPDATED: show ALL commands
      function nextHint(){
        if (st.phase==="pre") return `enable`;

        if (st.phase==="sw"){
          if (!st.sw.sawStatus) return `show interface status`;
          if (!st.sw.vlanSet) return `conf t
interface gi1/0/24
switchport access vlan 214
end`;
          if (!st.sw.saved) return `write memory`;
          return `next`;
        }

        if (st.phase==="fw"){
          if (!st.fw.ranPT) return `packet-tracer input inside tcp 10.214.0.10 51432 10.13.0.7 443 detailed`;
          if (!st.fw.aclAdded) return `conf t
access-list OUTSIDE-IN extended permit tcp host 10.214.0.10 host 10.13.0.7 eq 443
end`;
          if (!st.fw.agApplied) return `conf t
access-group OUTSIDE-IN in interface outside
end`;
          if (!st.fw.saved) return `write memory`;
          return `next`;
        }

        if (st.phase==="ise"){
          if (!st.ise.sawApp) return `show application status ise`;
          if (!st.ise.sawLogs) return `show logging application ise-auth.log tail`;
          return `next`;
        }

        if (st.phase==="vpn"){
          if (!st.vpn.sawIke) return `show crypto ikev2 sa`;
          if (!st.vpn.cleared) return `clear crypto ikev2 sa`;
          return `deliver`;
        }

        return "‚Äî";
      }

      function promptNext(){
        tLine("", "tDim");
        tLine("üëâ Type: next", "tInfo");
        setHint("next");
      }
      function promptDeliver(){
        tLine("", "tDim");
        tLine("üöÄ Type: deliver", "tInfo");
        setHint("deliver");
      }

      function reject(){
        errorSound();
        tLine("% Invalid input detected at '^' marker.", "tBad");
        setHint(nextHint());
      }

      // Ending hearts
      function startHearts(){
        heartsLayer.innerHTML = "";
        const makeHeart = () => {
          const h = document.createElement("div");
          h.className = "heart";
          h.textContent = "‚ù§Ô∏è";
          const left = Math.random() * 100;
          const dur = 6 + Math.random() * 6;
          const delay = Math.random() * 1.2;
          const scale = 0.7 + Math.random() * 1.1;
          h.style.left = left + "vw";
          h.style.animationDuration = dur + "s";
          h.style.animationDelay = delay + "s";
          h.style.transform = `translate3d(0, 120vh, 0) scale(${scale})`;
          heartsLayer.appendChild(h);
          setTimeout(()=>{ h.remove(); }, (dur + delay) * 1000 + 200);
        };
        for (let i=0;i<18;i++) makeHeart();
        setInterval(()=>{ for (let i=0;i<3;i++) makeHeart(); }, 600);
      }
      function showEnding(){
        termWin.style.display = "none";
        ending.style.display = "block";
        startHearts();
      }

      // Teams chat
      function clearChat(){ chatBody.innerHTML = ""; }
      function addBubble(text){
        const b = document.createElement("div");
        b.className = "bubble";
        b.textContent = text;
        chatBody.appendChild(b);
        chatPing();                 // NEW: ping per message
        teamsShowUnread(true);      // NEW: blink + badge
      }
      function addTyping(){
        const t = document.createElement("div");
        t.className = "typing";
        t.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span>';
        chatBody.appendChild(t);
        return t;
      }
      async function showYukiChatSequence(){
        chatOverlay.style.display = "block";
        chatOverlay.setAttribute("aria-hidden","false");
        clearChat();

        let typ = addTyping();
        notifSound();
        await new Promise(r=>setTimeout(r, 900));
        typ.remove();
        addBubble("Hi Nikhil I hope you are doing good");
        await new Promise(r=>setTimeout(r, 650));

        typ = addTyping();
        await new Promise(r=>setTimeout(r, 1100));
        typ.remove();
        addBubble("The case you assigned is priority 1 I need this to be sorted asap.");
        await new Promise(r=>setTimeout(r, 650));

        typ = addTyping();
        await new Promise(r=>setTimeout(r, 1300));
        typ.remove();
        addBubble("I know you are the right person you have always been the right person for this job ‚Ä¶. Well get to it bye now take care");

        // IMPORTANT: no auto close. user minimizes.
      }

      // Minimize chat (and stop blink/badge)
      function minimizeChat(){
        chatOverlay.style.display = "none";
        chatOverlay.setAttribute("aria-hidden","true");
        teamsShowUnread(false);
      }
      chatMin.addEventListener("click", minimizeChat);

      // Clicking Teams icon reopens chat if available
      teamsIcon.addEventListener("click", ()=>{
        if (chatBody.innerHTML.trim().length){
          chatOverlay.style.display="block";
          chatOverlay.setAttribute("aria-hidden","false");
          teamsShowUnread(false);
        }
      });

      // Open mail
      function openMail(){
        ensureAudio();
        notifSound();
        toast.style.display = "none";
        overlay.style.display = "block";
        overlay.setAttribute("aria-hidden","false");
      }
      toast.addEventListener("click", openMail);
      toast.addEventListener("keydown", (e)=>{ if(e.key==="Enter") openMail(); });

      closeMail.addEventListener("click", ()=>{
        overlay.style.display="none";
        overlay.setAttribute("aria-hidden","true");
      });

      // NO teleport
      function teleportNo(){
        ensureAudio();
        st.noTries++;
        errorSound();

        const area = assignArea.getBoundingClientRect();
        const btn = assignNo.getBoundingClientRect();
        const pad = 6;
        const maxX = Math.max(pad, area.width - btn.width - pad);
        const maxY = Math.max(pad, area.height - btn.height - pad);

        assignNo.style.left = (pad + Math.random()*maxX) + "px";
        assignNo.style.top  = (pad + Math.random()*maxY) + "px";

        attemptsEl.textContent = `Nice try. You can‚Äôt get me. (${st.noTries}/5)`;

        if (st.noTries >= 5){
          assignNo.style.display = "none";
          attemptsEl.textContent = "No option removed ‚úÖ Now click YES.";
          okSound();
        }
      }
      assignNo.addEventListener("mouseenter", teleportNo);
      assignNo.addEventListener("click", (e)=>{ e.preventDefault(); teleportNo(); });
      assignNo.addEventListener("touchstart", (e)=>{ e.preventDefault(); teleportNo(); }, {passive:false});

      async function startTerminalAfterChat(){
        overlay.style.display="none";
        overlay.setAttribute("aria-hidden","true");

        await showYukiChatSequence();

        // terminal opens right after chat is shown (chat stays until minimized)
        termWin.style.display="block";
        st.phase="pre";
        st.mode="exec";
        setDev("INCIDENT VAL-0214 ‚Ä¢ Trace started");

        tLine("üõ°Ô∏è OPERATION: SECURE THE HEART üõ°Ô∏è", "tInfo");
        tLine("P1: Traffic NOT REACHABLE (10.214.0.10 ‚Üí 10.13.0.7) TCP/443", "tWarn");
        tLine("Path: Switch ‚Üí Firewall ‚Üí ISE ‚Üí VPN ‚Üí Delivery", "tDim");
        tLine("", "tDim");
        tLine("Type: enable", "tOk");
        setHint("enable");
        cmdInput.focus();
      }

      assignYes.addEventListener("click", ()=>{
        ensureAudio();
        okSound();
        startTerminalAfterChat();
      });

      // Command engine
      function exec(cmdRaw){
        const cmd = cmdRaw.trim();
        const c = norm(cmdRaw);
        if (!cmd) return;

        cmdEcho(cmd);
        ensureAudio();

        if (c==="hint" || c==="hints"){ toggleHints(); return; }

        if (c==="end"){
          if (st.phase==="ise"){ reject(); return; }
          st.mode="exec"; okSound();
          tLine("Exited to privileged EXEC.", "tDim");
          setHint(nextHint());
          return;
        }
        if (c==="exit"){
          if (st.phase==="ise"){ reject(); return; }
          if (st.mode==="config-if"){ st.mode="config"; okSound(); tLine("Exit interface configuration mode.", "tDim"); setHint(nextHint()); return; }
          if (st.mode==="config"){ st.mode="exec"; okSound(); tLine("Exit configuration mode.", "tDim"); setHint(nextHint()); return; }
          tLine("% Use 'end' or 'logout' as appropriate.", "tWarn");
          setHint(nextHint());
          return;
        }

        // PRE
        if (st.phase==="pre"){
          if (c==="enable"){
            okSound();
            st.phase="sw";
            st.mode="exec";
            setDev("SW-CORE-01 ‚Ä¢ Access Layer");
            tLine("Password: ********", "tDim");
            tLine("Entering privileged mode‚Ä¶", "tDim");
            tLine("Access granted: role=NetworkSecurity | clearance=LOVE-PRIME", "tOk");
            tLine("", "tDim");
            tLine("=== HOP 1/4: SWITCH ===", "tInfo");
            tLine("Goal: Fix access VLAN on Gi1/0/24.", "tWarn");
            setHint(nextHint());
            return;
          }
          tLine("% Access denied. Type: enable", "tWarn");
          setHint(nextHint());
          return;
        }

        // SWITCH
        if (st.phase==="sw"){
          if (st.mode==="exec"){
            if (c==="show interface status"){
              st.sw.sawStatus=true;
              tLine("Port      Name               Status       Vlan       Duplex Speed Type", "tDim");
              if (!st.sw.vlanSet){
                errorSound();
                tLine("Gi1/0/24  NIKK-CLIENT         connected    999        a-full a-100 10/100/1000-TX", "tWarn");
                tLine("% VLAN mismatch: expected 214, found 999.", "tBad");
              } else {
                okSound();
                tLine("Gi1/0/24  NIKK-CLIENT         connected    214        a-full a-100 10/100/1000-TX", "tOk");
              }
              setHint(nextHint());
              return;
            }
            if (c==="conf t" || c==="configure terminal"){
              st.mode="config"; okSound();
              tLine("Enter configuration commands, one per line. End with CNTL/Z.", "tDim");
              setHint(nextHint()); return;
            }
            if (c==="write memory" || c==="wr mem"){
              if (!st.sw.vlanSet){
                errorSound(); tLine("% BLOCKED: VLAN not fixed yet.", "tWarn");
                setHint(nextHint()); return;
              }
              st.sw.saved=true; okSound();
              tLine("Building configuration... [OK]", "tOk");
              promptNext(); return;
            }
            if (c==="next"){
              if (!(st.sw.sawStatus && st.sw.vlanSet && st.sw.saved)){
                errorSound(); tLine("% BLOCKED: complete switch fix first.", "tWarn");
                setHint(nextHint()); return;
              }
              okSound();
              st.phase="fw";
              st.mode="exec";
              setDev("FW-EDGE-01 ‚Ä¢ Perimeter Firewall");
              tLine("", "tDim");
              tLine("=== HOP 2/4: FIREWALL ===", "tInfo");
              tLine("Goal: Allow TCP/443 from 10.214.0.10 to 10.13.0.7.", "tWarn");
              setHint(nextHint());
              return;
            }
            reject(); return;
          }
          if (st.mode==="config"){
            if (c==="interface gi1/0/24" || c==="interface gigabitethernet1/0/24"){
              st.mode="config-if"; okSound();
              tLine("Entering interface configuration mode.", "tDim");
              setHint(nextHint()); return;
            }
            reject(); return;
          }
          if (st.mode==="config-if"){
            if (c==="switchport access vlan 214"){
              st.sw.vlanSet=true; okSound();
              tLine("Set access VLAN 214 on Gi1/0/24.", "tOk");
              setHint(nextHint()); return;
            }
            reject(); return;
          }
        }

        // FIREWALL
        if (st.phase==="fw"){
          if (st.mode==="exec"){
            if (c.startsWith("packet-tracer input inside tcp 10.214.0.10 51432 10.13.0.7 443 detailed")){
              st.fw.ranPT=true;
              if (!st.fw.aclAdded){
                errorSound();
                tLine("Phase: 1  ROUTE-LOOKUP  Result: ALLOW", "tDim");
                tLine("Phase: 2  ACCESS-LIST   Result: DROP", "tBad");
                tLine("Drop-reason: (acl-drop) OUTSIDE-IN deny tcp any host 10.13.0.7 eq 443", "tBad");
              } else {
                okSound();
                tLine("Phase: 1  ROUTE-LOOKUP  Result: ALLOW", "tDim");
                tLine("Phase: 2  ACCESS-LIST   Result: ALLOW", "tOk");
                tLine("Result: ALLOW", "tOk");
              }
              setHint(nextHint()); return;
            }
            if (c==="conf t" || c==="configure terminal"){
              st.mode="config"; okSound();
              tLine("Enter configuration commands, one per line. End with CNTL/Z.", "tDim");
              setHint(nextHint()); return;
            }
            if (c==="write memory" || c==="wr mem"){
              if (!(st.fw.ranPT && st.fw.aclAdded && st.fw.agApplied)){
                errorSound();
                tLine("% BLOCKED: complete ACL + access-group first.", "tWarn");
                setHint(nextHint()); return;
              }
              st.fw.saved=true; okSound();
              tLine("Building configuration... [OK]", "tOk");
              promptNext(); return;
            }
            if (c==="next"){
              if (!(st.fw.ranPT && st.fw.aclAdded && st.fw.agApplied && st.fw.saved)){
                errorSound(); tLine("% BLOCKED: firewall steps incomplete.", "tWarn");
                setHint(nextHint()); return;
              }
              okSound();
              st.phase="ise";
              st.mode="exec";
              setDev("ISE-PSN-01 ‚Ä¢ Cisco ISE (ADE-OS)");
              tLine("", "tDim");
              tLine("=== HOP 3/4: ISE ===", "tInfo");
              tLine("Goal: Verify authZ status and logs.", "tWarn");
              setHint(nextHint());
              return;
            }
            reject(); return;
          }

          if (st.mode==="config"){
            if (c==="access-list outside-in extended permit tcp host 10.214.0.10 host 10.13.0.7 eq 443"){
              st.fw.aclAdded=true; okSound();
              tLine("ACL updated: OUTSIDE-IN permit tcp host 10.214.0.10 host 10.13.0.7 eq 443", "tOk");
              setHint(nextHint()); return;
            }
            if (c==="access-group outside-in in interface outside"){
              st.fw.agApplied=true; okSound();
              tLine("Applied access-group OUTSIDE-IN in interface outside", "tOk");
              setHint(nextHint()); return;
            }
            reject(); return;
          }
        }

        // ISE
        if (st.phase==="ise"){
          if (c==="show application status ise"){
            st.ise.sawApp=true; okSound();
            tLine("ISE PROCESS NAME                       STATE", "tDim");
            tLine("Application Server                     running", "tOk");
            tLine("Policy Service                         running", "tOk");
            setHint(nextHint()); return;
          }
          if (c==="show logging application ise-auth.log tail"){
            st.ise.sawLogs=true; errorSound();
            tLine("tail: ise-auth.log", "tDim");
            tLine("... AuthZ: ACCESS_REJECT (guest quarantine) for user nikkkuuuu", "tBad");
            tLine("... Next: policy updated by change owner (GUI) ‚Äî pending re-auth", "tWarn");
            promptNext();
            setHint(nextHint()); return;
          }
          if (c==="next"){
            if (!(st.ise.sawApp && st.ise.sawLogs)){
              errorSound(); tLine("% BLOCKED: check app status + auth logs first.", "tWarn");
              setHint(nextHint()); return;
            }
            okSound();
            st.phase="vpn";
            st.mode="exec";
            setDev("VPN-GW-01 ‚Ä¢ VPN Gateway");
            tLine("", "tDim");
            tLine("=== HOP 4/4: VPN ===", "tInfo");
            tLine("Goal: Verify IKEv2 SA then clear to renegotiate.", "tWarn");
            setHint(nextHint());
            return;
          }
          reject(); return;
        }

        // VPN
        if (st.phase==="vpn"){
          if (c==="show crypto ikev2 sa"){
            st.vpn.sawIke=true;
            tLine("IPv4 Crypto IKEv2  SA", "tDim");
            tLine("Tunnel-id Local               Remote              Status", "tDim");
            if (!st.vpn.cleared){
              errorSound();
              tLine("0        10.0.0.1:500         10.0.0.2:500         DOWN", "tBad");
              tLine("% Clear and renegotiate: clear crypto ikev2 sa", "tWarn");
            } else {
              okSound();
              tLine("7        10.0.0.1:500         10.0.0.2:500         UP-ACTIVE", "tOk");
              tLine("Encryption: AES-256  Integrity: SHA256  DPD: enabled", "tOk");
              promptDeliver();
            }
            setHint(nextHint()); return;
          }

          if (c==="clear crypto ikev2 sa"){
            if (!st.vpn.sawIke){
              errorSound(); tLine("% BLOCKED: verify first with 'show crypto ikev2 sa'.", "tWarn");
              setHint(nextHint()); return;
            }
            st.vpn.cleared=true; okSound();
            tLine("Clearing IKEv2 SAs‚Ä¶", "tDim");
            tLine("Re-negotiation initiated.", "tOk");
            tLine("Now re-check: show crypto ikev2 sa", "tInfo");
            setHint(nextHint()); return;
          }

          if (c==="deliver"){
            if (!(st.vpn.sawIke && st.vpn.cleared)){
              errorSound(); tLine("% BLOCKED: do 'show crypto ikev2 sa' + 'clear crypto ikev2 sa' first.", "tWarn");
              setHint(nextHint()); return;
            }
            okSound();
            tLine("", "tDim");
            tLine("=== DELIVERY ===", "tInfo");
            tLine("Payload successful ‚úÖ", "tOk");
            setTimeout(showEnding, 900);
            return;
          }

          reject(); return;
        }

        reject();
      }

      function runNow(){
        const v = cmdInput.value;
        cmdInput.value = "";
        exec(v);
      }
      runBtn.addEventListener("click", runNow);
      cmdInput.addEventListener("keydown", (e)=>{ if(e.key==="Enter") runNow(); });

      // Boot
      mailTime.textContent = new Date().toLocaleString();
      setTimeout(()=>{ toast.style.display = "block"; }, 650);
      setHint("enable");
    })();
  </script>
</body>
</html>
```

