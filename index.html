<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Operation: Secure The Heart</title>
  <style>
    :root{
      --bg:#05070b;
      --panel:rgba(8,12,18,.78);
      --border:rgba(0,255,157,.22);
      --text:#b8ffd9;
      --dim:rgba(184,255,217,.72);
      --green:#00ff9d;
      --yellow:#ffd86b;
      --red:#ff5c7a;
      --blue:#7dd3fc;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      padding:16px;
      display:grid;
      place-items:center;
      background:
        radial-gradient(1200px 700px at 50% -10%, rgba(0,255,157,.13), transparent 60%),
        radial-gradient(900px 500px at 85% 5%, rgba(255,216,107,.08), transparent 60%),
        radial-gradient(900px 500px at 10% 10%, rgba(125,211,252,.06), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
    }
    .wrap{width:min(1000px, 100%)}
    .bar{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 12px;
      border:1px solid var(--border);
      background:var(--panel);
      border-radius:14px;
      margin-bottom:10px;
    }
    .dots{display:flex; gap:6px; align-items:center}
    .dot{width:10px;height:10px;border-radius:99px}
    .dot.r{background:var(--red)} .dot.y{background:var(--yellow)} .dot.g{background:var(--green)}
    .title{font-size:12px; opacity:.9}
    .badge{font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); color:var(--dim)}
    .grid{display:grid; grid-template-columns: 1.25fr .75fr; gap:10px}
    @media(max-width:900px){ .grid{grid-template-columns:1fr} }

    .panel{
      border:1px solid var(--border);
      background:var(--panel);
      border-radius:18px;
      overflow:hidden;
    }
    .head{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      color:var(--dim);
      font-size:12px;
    }
    .screen{
      height:min(64vh,600px);
      padding:14px 14px 6px;
      overflow:auto;
      scroll-behavior:smooth;
      line-height:1.55;
      font-size:14px;
      white-space:pre-wrap;
    }
    .line{margin:0 0 6px 0}
    .dim{color:var(--dim)}
    .ok{color:var(--green)}
    .warn{color:var(--yellow)}
    .bad{color:var(--red)}
    .info{color:var(--blue)}
    .cmd{color:var(--text)}

    .inputbar{
      display:flex; gap:10px; padding:10px 12px;
      border-top:1px solid var(--border);
      background:rgba(0,0,0,.25);
    }
    input{
      flex:1;
      border:1px solid var(--border);
      background:rgba(0,0,0,.30);
      color:var(--green);
      padding:12px 12px;
      border-radius:12px;
      font-size:14px;
      outline:none;
    }
    input::placeholder{color:rgba(0,255,157,.35)}
    button{
      border:1px solid var(--border);
      background:rgba(0,0,0,.28);
      color:var(--green);
      padding:12px 14px;
      border-radius:12px;
      cursor:pointer;
      font-weight:800;
      font-size:14px;
      touch-action:manipulation;
      user-select:none;
    }
    button:hover{background:rgba(0,255,157,.10)}
    .side{
      border:1px solid var(--border);
      background:var(--panel);
      border-radius:18px;
      padding:12px;
    }
    .side h3{
      margin:0 0 10px;
      font-size:12px;
      color:var(--dim);
      letter-spacing:.10em;
      text-transform:uppercase;
    }
    .cmds{display:flex; flex-wrap:wrap; gap:10px}
    .chip{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.25);
      color:var(--text);
      font-size:13px;
      cursor:pointer;
    }
    .chip:active{transform:translateY(1px)}
    .actions{margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .allow{
      background:rgba(0,255,157,.16);
      border:1px solid rgba(0,255,157,.35);
    }

    /* DENY dodge */
    .denyWrap{position:relative; height:44px; min-width:180px}
    .deny{
      position:absolute; left:0; top:0;
      border:1px solid rgba(255,92,122,.45);
      color:rgba(255,92,122,.95);
      background:rgba(255,92,122,.08);
      transition:transform .12s ease;
      width:100%;
    }

    /* Smart hint area (hidden by default) */
    .hint{
      display:none;
      margin-top:10px;
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(255,216,107,.25);
      background:rgba(255,216,107,.08);
      color:rgba(255,216,107,.95);
      font-size:12px;
      line-height:1.45;
    }

    @media (max-width:480px){
      .screen{font-size:13px}
      button,input{font-size:15px}
      .denyWrap{min-width:160px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="bar">
      <div style="display:flex; gap:10px; align-items:center">
        <div class="dots"><span class="dot r"></span><span class="dot y"></span><span class="dot g"></span></div>
        <div class="title">Weston-NOC ‚Ä¢ Operation Console</div>
      </div>
      <div class="badge">Mission: <b>SECURE THE HEART</b></div>
    </div>

    <div class="grid">
      <div class="panel">
        <div class="head">
          <div>ssh nikkkuuuu@core-infra</div>
          <div class="dim" id="deviceLabel">CLASSIFIED ‚Ä¢ awaiting command‚Ä¶</div>
        </div>

        <div class="screen" id="screen"></div>

        <div class="inputbar">
          <input id="cmdInput" placeholder="Type: enable  (or tap a quick command)" autocomplete="off" />
          <button id="runBtn">Run</button>
        </div>
      </div>

      <div class="side">
        <h3>Quick commands</h3>
        <div class="cmds" id="quickCmds"></div>

        <div class="actions">
          <button class="allow" id="allowBtn">‚úÖ APPROVE (ALLOW)</button>
          <div class="denyWrap">
            <button class="deny" id="denyBtn">‚ùå DENY</button>
          </div>
        </div>

        <!-- Smart hints only show when needed -->
        <div class="hint" id="hint"></div>
      </div>
    </div>
  </div>

<script>
(() => {
  const screen = document.getElementById('screen');
  const input = document.getElementById('cmdInput');
  const runBtn = document.getElementById('runBtn');
  const quickCmds = document.getElementById('quickCmds');
  const allowBtn = document.getElementById('allowBtn');
  const denyBtn = document.getElementById('denyBtn');
  const deviceLabel = document.getElementById('deviceLabel');
  const hintBox = document.getElementById('hint');

  // --- smart hint system (hidden by default)
  let hintTimer = null;
  function clearHint(){
    if (hintTimer) clearTimeout(hintTimer);
    hintTimer = null;
    hintBox.style.display = "none";
    hintBox.textContent = "";
  }
  function showHint(message){
    if (hintTimer) clearTimeout(hintTimer);
    hintTimer = null;
    hintBox.textContent = "üõ∞Ô∏è Intel: " + message;
    hintBox.style.display = "block";
  }
  function scheduleHint(message, delay=7000){
    clearHint();
    hintTimer = setTimeout(() => showHint(message), delay);
  }

  const st = {
    phase: "intro",           // intro, switch, firewall, ise, vpn, delivered
    enabled: false,
    fixedVlan: false,
    fixedFw: false,
    fixedIse: false,
    fixedVpn: false,
    denyDodges: 0
  };

  function setDevice(name){
    deviceLabel.textContent = name;
  }

  function p(text, cls="line"){
    const el = document.createElement('p');
    el.className = `line ${cls}`;
    el.textContent = text;
    screen.appendChild(el);
    screen.scrollTop = screen.scrollHeight;
  }

  function promptLine(cmd){
    p(`${currentPrompt()} ${cmd}`, "cmd");
  }

  function currentPrompt(){
    if (st.phase === "switch") return "SW-CORE-01#";
    if (st.phase === "firewall") return "FW-EDGE-01#";
    if (st.phase === "ise") return "ISE-PSN-01#";
    if (st.phase === "vpn") return "VPN-GW-01#";
    if (st.phase === "delivered") return "CHANGE-MGR#";
    return "CLASSIFIED#";
  }

  function clearQuick(){ quickCmds.innerHTML = ""; }

  function addChip(label, cmd){
    const b = document.createElement('div');
    b.className = "chip";
    b.textContent = label;
    b.addEventListener('click', () => run(cmd));
    quickCmds.appendChild(b);
  }

  function refreshQuick(){
    clearQuick();

    if (!st.enabled){
      addChip("enable", "enable");
      addChip("help", "help");
      addChip("show mission", "show mission");
      return;
    }

    if (st.phase === "switch"){
      addChip("show interface status", "show interface status");
      addChip("show vlan brief", "show vlan brief");
      if (!st.fixedVlan) addChip("fix vlan", "conf t ; interface Gi1/0/24 ; switchport access vlan 214 ; end ; wr mem");
      addChip("next ‚Üí firewall", "next");
      return;
    }

    if (st.phase === "firewall"){
      addChip("show access-list", "show access-list");
      addChip("packet-tracer", "packet-tracer input inside tcp NIKK 51432 SIVA 443");
      if (!st.fixedFw) addChip("fix acl allow 443", "fix acl allow 443");
      addChip("next ‚Üí ISE", "next");
      return;
    }

    if (st.phase === "ise"){
      addChip("show live logs", "show live logs");
      addChip("show auth status", "show authentication status");
      if (!st.fixedIse) addChip("fix policy (permit)", "fix ise");
      addChip("next ‚Üí VPN", "next");
      return;
    }

    if (st.phase === "vpn"){
      addChip("show crypto ikev2 sa", "show crypto ikev2 sa");
      addChip("ping SIVA via tunnel", "ping siva source tunnel0");
      if (!st.fixedVpn) addChip("rekey / bring tunnel up", "fix vpn");
      addChip("deliver payload", "deliver");
      return;
    }

    if (st.phase === "delivered"){
      addChip("show packet-capture", "show packet-capture");
      addChip("replay ending", "replay");
      return;
    }
  }

  function intro(){
    setDevice("CLASSIFIED ‚Ä¢ Encrypted Channel Established");
    p("üåå OPERATION: SECURE THE HEART üåå", "info");
    p("Classified Transmission ‚Äì Encrypted Channel Established", "dim");
    p("", "dim");
    p("23:59 hours. Production environment.", "dim");
    p("A single packet leaves Nikkkuuuu‚Äôs network.", "dim");
    p("Its destination‚Ä¶ Siva.", "dim");
    p("", "dim");
    p("Payload (encrypted):", "dim");
    p("\"I love you.\"", "ok");
    p("", "dim");
    p("But the transmission fails.", "warn");
    p("Somewhere between the access layer and the edge gateway‚Ä¶ the connection is being blocked.", "warn");
    p("", "dim");
    p("Traffic Path:", "dim");
    p("Nikkkuuuu ‚Üí Switch ‚Üí Firewall ‚Üí ISE ‚Üí VPN Tunnel ‚Üí Siva", "info");
    p("", "dim");
    p("üë®‚Äçüíª Network Engineer Nikkkuuuu‚Ä¶", "dim");
    p("Type: enable", "ok");
    refreshQuick();
    clearHint();
    scheduleHint("Start by typing `enable` to enter privileged mode.", 6000);
  }

  function movePhase(newPhase){
    st.phase = newPhase;
    clearHint();

    if (newPhase === "switch"){
      setDevice("SW-CORE-01 ‚Ä¢ Access Layer");
      p("", "dim");
      p("=== Hop 1/4: SWITCH ===", "info");
      p("Objective: Confirm VLAN + port state. Love packets must exit access layer.", "dim");
      scheduleHint("Try `show interface status` to check VLAN/port state.", 6500);
    }
    if (newPhase === "firewall"){
      setDevice("FW-EDGE-01 ‚Ä¢ Perimeter Firewall");
      p("", "dim");
      p("=== Hop 2/4: FIREWALL ===", "info");
      p("Objective: Inspect policy. TCP/443 must be allowed from Nikkkuuuu ‚Üí Siva.", "dim");
      scheduleHint("Use `packet-tracer` or `show access-list` to find the drop.", 6500);
    }
    if (newPhase === "ise"){
      setDevice("ISE-PSN-01 ‚Ä¢ Policy Enforcement");
      p("", "dim");
      p("=== Hop 3/4: ISE ===", "info");
      p("Objective: Ensure Nikkkuuuu is AUTHORIZED (not ACCESS_REJECT).", "dim");
      scheduleHint("Run `show live logs` to see why auth is failing.", 6500);
    }
    if (newPhase === "vpn"){
      setDevice("VPN-GW-01 ‚Ä¢ Tunnel Gateway");
      p("", "dim");
      p("=== Hop 4/4: VPN ===", "info");
      p("Objective: Bring tunnel UP and deliver payload safely.", "dim");
      scheduleHint("Run `show crypto ikev2 sa` to check tunnel state.", 6500);
    }
    if (newPhase === "delivered"){
      setDevice("CHANGE-MGR ‚Ä¢ Payload Delivery");
      clearHint();
    }

    refreshQuick();
  }

  function normalize(s){
    return (s||"").trim().toLowerCase().replace(/\s+/g,' ');
  }

  function run(raw){
    clearHint(); // hide hints once he acts
    const cmd = (raw||input.value||"").trim();
    if (!cmd) return;
    input.value = "";

    const parts = cmd.split(";").map(s=>s.trim()).filter(Boolean);
    (async () => {
      for (const part of parts){
        await execOne(part);
      }
      refreshQuick();
    })();
  }

  async function execOne(cmd){
    const c = normalize(cmd);

    // Global helpers
    if (c === "help"){
      promptLine(cmd);
      p("Available: enable | show mission | next | deliver | device-specific show/fix commands", "dim");
      scheduleHint("Use the quick commands on the right if you don‚Äôt want to type.", 6500);
      return;
    }
    if (c === "show mission"){
      promptLine(cmd);
      p("Mission: Nikkkuuuu traffic to Siva over TCP/443 is failing.", "dim");
      p("Fix path: Switch ‚Üí Firewall ‚Üí ISE ‚Üí VPN ‚Üí Delivery", "dim");
      return;
    }

    // Intro
    if (!st.enabled){
      if (c === "enable"){
        promptLine(cmd);
        p("Entering privileged mode‚Ä¶", "dim");
        p("Access granted: role=NetworkSecurity | clearance=LOVE-PRIME", "ok");
        st.enabled = true;
        movePhase("switch");
        return;
      }
      promptLine(cmd);
      p("Access denied. Type: enable", "warn");
      showHint("Type `enable` first.");
      return;
    }

    // SWITCH phase
    if (st.phase === "switch"){
      if (c === "show interface status"){
        promptLine(cmd);
        p("Port      Name               Status       Vlan       Duplex Speed Type", "dim");
        p("Gi1/0/24  NIKK-CLIENT         connected    999        a-full a-100 10/100/1000-TX", st.fixedVlan ? "ok" : "warn");
        if (!st.fixedVlan){
          p("‚ö†Ô∏è VLAN mismatch. Expected VLAN 214 (VALENTINE). Found VLAN 999 (QUARANTINE).", "warn");
          showHint("Fix it by running the quick command `fix vlan`.");
        } else {
          p("‚úÖ Port is on VLAN 214. Love packets can leave the access layer.", "ok");
        }
        return;
      }
      if (c === "show vlan brief"){
        promptLine(cmd);
        p("VLAN Name                             Status    Ports", "dim");
        p("214  VALENTINE                         active", "ok");
        p("999  QUARANTINE                        active    Gi1/0/24", st.fixedVlan ? "dim" : "warn");
        if (!st.fixedVlan) showHint("Move Gi1/0/24 to VLAN 214 (use `fix vlan`).");
        return;
      }
      if (c.startsWith("conf t") || c.startsWith("configure terminal") || c.includes("switchport access vlan 214") || c.includes("wr mem")){
        promptLine(cmd);
        if (!st.fixedVlan){
          p("Applying change‚Ä¶", "dim");
          p("Gi1/0/24 moved: VLAN 999 ‚Üí VLAN 214", "ok");
          p("write memory‚Ä¶ done", "ok");
          st.fixedVlan = true;
        } else {
          p("No changes required. VLAN already correct.", "dim");
        }
        return;
      }
      if (c === "next"){
        promptLine(cmd);
        if (!st.fixedVlan){
          p("Blocked: fix VLAN first (Gi1/0/24 must be on VLAN 214).", "warn");
          showHint("Run `show interface status` then `fix vlan`.");
        } else {
          p("Handoff complete. Forwarding traffic to perimeter‚Ä¶", "ok");
          movePhase("firewall");
        }
        return;
      }

      promptLine(cmd);
      p("Unknown command.", "warn");
      scheduleHint("Try `show interface status` (then fix VLAN if needed).", 3000);
      return;
    }

    // FIREWALL phase
    if (st.phase === "firewall"){
      if (c === "show access-list"){
        promptLine(cmd);
        p("access-list OUTSIDE-IN; 3 elements", "dim");
        p("1: deny tcp any host SIVA eq 443  (hitcnt=42)", st.fixedFw ? "dim" : "bad");
        p("2: permit tcp host NIKK any eq 22 (hitcnt=3)", "dim");
        p("3: deny ip any any (hitcnt=999)", "dim");
        if (!st.fixedFw){
          p("‚ùå Rule 1 is dropping tcp/443 to Siva.", "bad");
          showHint("Add permit for NIKK ‚Üí SIVA eq 443 using `fix acl allow 443`.");
        } else {
          p("‚úÖ 443 is permitted. No drops detected.", "ok");
        }
        return;
      }
      if (c.startsWith("packet-tracer")){
        promptLine(cmd);
        if (!st.fixedFw){
          p("Phase: 1  ROUTE-LOOKUP  ... ALLOW", "dim");
          p("Phase: 2  ACCESS-LIST   ... DROP", "bad");
          p("Result: DROP (acl OUTSIDE-IN line 1)", "bad");
          showHint("Fix ACL: permit tcp NIKK ‚Üí SIVA eq 443 (use `fix acl allow 443`).");
        } else {
          p("Phase: 1 ROUTE-LOOKUP ... ALLOW", "dim");
          p("Phase: 2 ACCESS-LIST  ... ALLOW", "ok");
          p("Result: ALLOW", "ok");
        }
        return;
      }
      if (c === "fix acl allow 443" || c === "fix acl"){
        promptLine(cmd);
        p("Applying policy update‚Ä¶", "dim");
        p("Removed: deny tcp any host SIVA eq 443", "ok");
        p("Added:   permit tcp host NIKK host SIVA eq 443", "ok");
        p("Commit complete.", "ok");
        st.fixedFw = true;
        return;
      }
      if (c === "next"){
        promptLine(cmd);
        if (!st.fixedFw){
          p("Blocked: 443 still being dropped. Fix ACL first.", "warn");
          showHint("Run `show access-list` then `fix acl allow 443`.");
        } else {
          p("Firewall cleared. Passing traffic to policy engine‚Ä¶", "ok");
          movePhase("ise");
        }
        return;
      }

      promptLine(cmd);
      p("Unknown command.", "warn");
      scheduleHint("Try `show access-list` or `packet-tracer`.", 3000);
      return;
    }

    // ISE phase
    if (st.phase === "ise"){
      if (c === "show live logs"){
        promptLine(cmd);
        if (!st.fixedIse){
          p("Event 5400 Authentication failed", "bad");
          p("Failure Reason: 15039 Rejected per authorization profile", "bad");
          p("Authorization Profile: ACCESS_REJECT", "bad");
          p("User: nikkkuuuu", "warn");
          showHint("Fix policy mapping so nikkkuuuu matches VALENTINE_PERMIT (use `fix ise`).");
        } else {
          p("Event 22037 Authentication succeeded", "ok");
          p("Authorization Profile: VALENTINE_PERMIT", "ok");
          p("User: nikkkuuuu", "ok");
        }
        return;
      }
      if (c === "show authentication status"){
        promptLine(cmd);
        if (!st.fixedIse){
          p("User: nikkkuuuu", "dim");
          p("Status: REJECTED (ACCESS_REJECT)", "bad");
          showHint("Run `fix ise` to allow him in üòè");
        } else {
          p("User: nikkkuuuu", "dim");
          p("Status: AUTHORIZED", "ok");
          p("Profile: VALENTINE_PERMIT", "ok");
        }
        return;
      }
      if (c === "fix ise"){
        promptLine(cmd);
        p("Updating authorization policy‚Ä¶", "dim");
        p("Rule match updated: nikkkuuuu ‚Üí VALENTINE_PERMIT", "ok");
        p("Policy push complete.", "ok");
        st.fixedIse = true;
        return;
      }
      if (c === "next"){
        promptLine(cmd);
        if (!st.fixedIse){
          p("Blocked: ISE still rejecting. Fix policy first.", "warn");
          showHint("Run `show live logs` then `fix ise`.");
        } else {
          p("ISE authorized. Establishing tunnel path‚Ä¶", "ok");
          movePhase("vpn");
        }
        return;
      }

      promptLine(cmd);
      p("Unknown command.", "warn");
      scheduleHint("Try `show live logs` or `show authentication status`.", 3000);
      return;
    }

    // VPN phase
    if (st.phase === "vpn"){
      if (c === "show crypto ikev2 sa"){
        promptLine(cmd);
        if (!st.fixedVpn){
          p("Session-id: 0, Status: DOWN", "bad");
          p("Reason: key exchange pending / missing love key üòè", "warn");
          showHint("Bring the tunnel up using `fix vpn`.");
        } else {
          p("Session-id: 7, Status: UP-ACTIVE", "ok");
          p("Encryption: AES-FOREVER  Integrity: HMAC-üíö", "ok");
        }
        return;
      }
      if (c === "ping siva source tunnel0"){
        promptLine(cmd);
        if (!st.fixedVpn){
          p(".....", "warn");
          p("Success rate is 0 percent (timeout)", "bad");
          showHint("Tunnel is down ‚Äî run `fix vpn` then ping again.");
        } else {
          p("!!!!!", "ok");
          p("Success rate is 100 percent (5/5)", "ok");
        }
        return;
      }
      if (c === "fix vpn"){
        promptLine(cmd);
        p("Initiating rekey‚Ä¶", "dim");
        p("Generating: LOVE-KEY (2048-bit)", "ok");
        p("IKEv2 negotiation‚Ä¶ complete", "ok");
        p("Tunnel0: UP", "ok");
        st.fixedVpn = true;
        return;
      }
      if (c === "deliver"){
        promptLine(cmd);
        if (!st.fixedVpn){
          p("Blocked: Tunnel is still DOWN. Bring it up first.", "warn");
          showHint("Run `show crypto ikev2 sa` then `fix vpn`.");
        } else {
          st.phase = "delivered";
          setDevice("CHANGE-MGR ‚Ä¢ Payload Delivery");
          clearHint();
          p("", "dim");
          p("=== DELIVERY ===", "info");
          p("Capturing traffic on tcp/443 ‚Ä¶", "dim");
          p("Packets in flight‚Ä¶", "dim");
          p("‚úÖ Traffic delivered to Siva successfully.", "ok");
          p("", "dim");
          p("Packet Capture:", "dim");
          p("SRC: NIKK   DST: SIVA   PROTO: TCP/443   FLAG: PSH,ACK", "ok");
          p("PAYLOAD:", "dim");
          p("\"I love you, my forever Valentine, Nikkkuuuu üíñ\"", "ok");
          p("", "dim");
          p("Status: Production love tunnel established. Failover: NEVER.", "info");
          p("", "dim");
          p("Type: show packet-capture", "dim");
          refreshQuick();
        }
        return;
      }

      promptLine(cmd);
      p("Unknown command.", "warn");
      scheduleHint("Try `show crypto ikev2 sa` then `fix vpn`, then `deliver`.", 3000);
      return;
    }

    // delivered
    if (st.phase === "delivered"){
      if (c === "show packet-capture"){
        promptLine(cmd);
        p("PCAP Summary:", "dim");
        p("Frames: 14   Drops: 0   Latency: 0ms (when she smiles)", "ok");
        p("Final Payload: \"I love you, my forever Valentine, Nikkkuuuu üíñ\"", "ok");
        return;
      }
      if (c === "replay"){
        promptLine(cmd);
        p("Replaying ending‚Ä¶", "dim");
        p("‚úÖ Traffic delivered to Siva successfully.", "ok");
        p("\"I love you, my forever Valentine, Nikkkuuuu üíñ\"", "ok");
        return;
      }
      promptLine(cmd);
      p("Mission complete. Try: show packet-capture", "dim");
      return;
    }
  }

  // APPROVE / DENY actions
  allowBtn.addEventListener('click', () => {
    p("", "dim");
    p("CAB APPROVAL RECEIVED ‚úÖ", "ok");
    p("Change ID: ALLOW-NIKKKUUUU-443", "dim");
    p("Proceeding‚Ä¶", "dim");
    scheduleHint("Start with `enable` if you haven't already.", 3500);
  });

  function dodge(){
    st.denyDodges++;
    const wrap = denyBtn.parentElement;
    const w = wrap.clientWidth;
    const h = wrap.clientHeight;
    const dx = Math.floor((Math.random() * (w - 40)) - (w/2 - 20));
    const dy = Math.floor((Math.random() * (h - 30)) - (h/2 - 15));
    denyBtn.style.transform = `translate(${dx}px, ${dy}px)`;
    if (st.denyDodges === 1) p("‚ùå DENY attempt detected‚Ä¶ evasive manoeuvres engaged üòÇ", "warn");
    if (st.denyDodges === 3) p("DENY is out of scope. This change is love-approved only üòè", "warn");
    showHint("Nice try üòå You must restore traffic.");
  }

  denyBtn.addEventListener('mouseenter', dodge);
  denyBtn.addEventListener('touchstart', (e) => { e.preventDefault(); dodge(); }, {passive:false});
  denyBtn.addEventListener('click', () => { dodge(); });

  runBtn.addEventListener('click', () => run());
  input.addEventListener('keydown', (e) => { if (e.key === "Enter") run(); });

  // Boot intro
  intro();
  refreshQuick();
})();
</script>
</body>
</html>
